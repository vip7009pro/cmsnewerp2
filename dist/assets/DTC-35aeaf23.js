import{a as Re,g as Ae,s as ae,_ as Y,r as s,u as Me,b as me,j as e,d as ve,e as we,aG as He,c as Pe,aH as Be,aI as Ye,k as Ie,am as le,ap as ie,aq as re,ar as ce,as as fe,at as de,au as Ee,av as ue,aw as p,I as se,ak as ne,al as oe,ax as he,ay as Te,az as Ce,aA as xe,aB as _e,aE as r,S as f,ad as j,ai as B,aj as We,aC as ye,aD as ke}from"./index-4ab6dde0.js";import{S as ze,F as Le,C as Ve,D as Qe,G as $e,b as qe,A as je,c as Xe}from"./DataGrid-b5e0acb2.js";import{T as Fe}from"./Typography-b6d023f3.js";import{b as Ze,f as Je,c as Ke,e as et,g as tt,h as at,T as Ne}from"./TextField-db9fe3d0.js";import"./MenuItem-8199bc03.js";function st(n){return Re("MuiFormGroup",n)}Ae("MuiFormGroup",["root","row","error"]);const nt=["className","row"],ot=n=>{const{classes:d,row:C,error:x}=n;return we({root:["root",C&&"row",x&&"error"]},st,d)},lt=ae("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(n,d)=>{const{ownerState:C}=n;return[d.root,C.row&&d.row]}})(({ownerState:n})=>Y({display:"flex",flexDirection:"column",flexWrap:"wrap"},n.row&&{flexDirection:"row"})),it=s.forwardRef(function(d,C){const x=Me({props:d,name:"MuiFormGroup"}),{className:c,row:D=!1}=x,S=me(x,nt),R=Ze(),M=Je({props:x,muiFormControl:R,states:["error"]}),v=Y({},x,{row:D,error:M.error}),E=ot(v);return e.jsx(lt,Y({className:ve(E.root,c),ownerState:v,ref:C},S))}),rt=it,ct=Ke(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"RadioButtonUnchecked"),dt=Ke(e.jsx("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"}),"RadioButtonChecked"),Et=ae("span")({position:"relative",display:"flex"}),ut=ae(ct)({transform:"scale(1)"}),ht=ae(dt)(({theme:n,ownerState:d})=>Y({left:0,position:"absolute",transform:"scale(0)",transition:n.transitions.create("transform",{easing:n.transitions.easing.easeIn,duration:n.transitions.duration.shortest})},d.checked&&{transform:"scale(1)",transition:n.transitions.create("transform",{easing:n.transitions.easing.easeOut,duration:n.transitions.duration.shortest})}));function Ge(n){const{checked:d=!1,classes:C={},fontSize:x}=n,c=Y({},n,{checked:d});return e.jsxs(Et,{className:C.root,ownerState:c,children:[e.jsx(ut,{fontSize:x,className:C.background,ownerState:c}),e.jsx(ht,{fontSize:x,className:C.dot,ownerState:c})]})}const Tt=s.createContext(void 0),Ue=Tt;function Ct(){return s.useContext(Ue)}function xt(n){return Re("MuiRadio",n)}const _t=Ae("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary"]),ge=_t,Dt=["checked","checkedIcon","color","icon","name","onChange","size","className"],St=n=>{const{classes:d,color:C}=n,x={root:["root",`color${Pe(C)}`]};return Y({},d,we(x,xt,d))},mt=ae(ze,{shouldForwardProp:n=>He(n)||n==="classes",name:"MuiRadio",slot:"Root",overridesResolver:(n,d)=>{const{ownerState:C}=n;return[d.root,d[`color${Pe(C.color)}`]]}})(({theme:n,ownerState:d})=>Y({color:(n.vars||n).palette.text.secondary},!d.disableRipple&&{"&:hover":{backgroundColor:n.vars?`rgba(${d.color==="default"?n.vars.palette.action.activeChannel:n.vars.palette[d.color].mainChannel} / ${n.vars.palette.action.hoverOpacity})`:Be(d.color==="default"?n.palette.action.active:n.palette[d.color].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},d.color!=="default"&&{[`&.${ge.checked}`]:{color:(n.vars||n).palette[d.color].main}},{[`&.${ge.disabled}`]:{color:(n.vars||n).palette.action.disabled}}));function ft(n,d){return typeof d=="object"&&d!==null?n===d:String(n)===String(d)}const Oe=e.jsx(Ge,{checked:!0}),be=e.jsx(Ge,{}),pt=s.forwardRef(function(d,C){var x,c;const D=Me({props:d,name:"MuiRadio"}),{checked:S,checkedIcon:R=Oe,color:M="primary",icon:v=be,name:E,onChange:w,size:O="medium",className:P}=D,I=me(D,Dt),y=Y({},D,{color:M,size:O}),N=St(y),k=Ct();let u=S;const h=et(w,k&&k.onChange);let _=E;return k&&(typeof u>"u"&&(u=ft(k.value,D.value)),typeof _>"u"&&(_=k.name)),e.jsx(mt,Y({type:"radio",icon:s.cloneElement(v,{fontSize:(x=be.props.fontSize)!=null?x:O}),checkedIcon:s.cloneElement(R,{fontSize:(c=Oe.props.fontSize)!=null?c:O}),ownerState:y,classes:N,name:_,checked:u,onChange:h,ref:C,className:ve(N.root,P)},I))}),jt=pt,Nt=["actions","children","defaultValue","name","onChange","value"],gt=s.forwardRef(function(d,C){const{actions:x,children:c,defaultValue:D,name:S,onChange:R,value:M}=d,v=me(d,Nt),E=s.useRef(null),[w,O]=tt({controlled:M,default:D,name:"RadioGroup"});s.useImperativeHandle(x,()=>({focus:()=>{let N=E.current.querySelector("input:not(:disabled):checked");N||(N=E.current.querySelector("input:not(:disabled)")),N&&N.focus()}}),[]);const P=Ye(C,E),I=at(S),y=s.useMemo(()=>({name:I,onChange(N){O(N.target.value),R&&R(N,N.target.value)},value:w}),[I,R,O,w]);return e.jsx(Ue.Provider,{value:y,children:e.jsx(rt,Y({role:"radiogroup",ref:P},v,{children:c}))})}),Ot=gt;const bt=()=>{const n=Ie(t=>t.totalSlice.userData),[d,C]=s.useState("3"),[x,c]=s.useState(""),[D,S]=s.useState((n==null?void 0:n.SUBDEPTNAME)==="IQC"),[R,M]=s.useState(""),[v,E]=s.useState(""),[w,O]=s.useState([{TEST_CODE:"1",TEST_NAME:"Kích thước",SELECTED:!1},{TEST_CODE:"2",TEST_NAME:"Kéo keo",SELECTED:!1},{TEST_CODE:"3",TEST_NAME:"XRF",SELECTED:!1},{TEST_CODE:"4",TEST_NAME:"Điện trở",SELECTED:!1},{TEST_CODE:"5",TEST_NAME:"Tĩnh điện",SELECTED:!1},{TEST_CODE:"6",TEST_NAME:"Độ bóng",SELECTED:!1},{TEST_CODE:"7",TEST_NAME:"Phtalate",SELECTED:!1},{TEST_CODE:"8",TEST_NAME:"FTIR",SELECTED:!1},{TEST_CODE:"9",TEST_NAME:"Mài mòn",SELECTED:!1},{TEST_CODE:"10",TEST_NAME:"Màu sắc",SELECTED:!1},{TEST_CODE:"11",TEST_NAME:"TVOC",SELECTED:!1},{TEST_CODE:"12",TEST_NAME:"Cân nặng",SELECTED:!1},{TEST_CODE:"13",TEST_NAME:"Scanbarcode",SELECTED:!1},{TEST_CODE:"14",TEST_NAME:"Nhiệt cao Ẩm cao",SELECTED:!1},{TEST_CODE:"15",TEST_NAME:"Shock nhiệt",SELECTED:!1},{TEST_CODE:"1002",TEST_NAME:"Kéo keo 2",SELECTED:!1},{TEST_CODE:"1003",TEST_NAME:"Ngoại Quan",SELECTED:!1},{TEST_CODE:"1005",TEST_NAME:"Độ dày",SELECTED:!1}]),[P,I]=s.useState([]);s.useState([]);const[y,N]=s.useState(""),[k,u]=s.useState(""),[h,_]=s.useState(""),[K,L]=s.useState(""),[H,q]=s.useState(""),[m,W]=s.useState(""),[G,U]=s.useState(""),[o,A]=s.useState(""),[z,$]=s.useState([]),b=le.useMemo(()=>e.jsx("div",{className:"datatb",children:e.jsxs(ie,{style:{fontSize:"0.7rem"},autoNavigateToFocusedRow:!0,allowColumnReordering:!0,allowColumnResizing:!0,columnAutoWidth:!1,cellHintEnabled:!0,columnResizingMode:"widget",showColumnLines:!0,dataSource:P,columnWidth:"auto",keyExpr:"id",height:"71vh",showBorders:!0,onSelectionChanged:t=>{},onRowClick:t=>{},children:[e.jsx(re,{editOnKeyPress:!0,enterKeyAction:"moveFocus",enterKeyDirection:"column"}),e.jsx(ce,{useNative:!0,scrollByContent:!0,scrollByThumb:!0,showScrollbar:"onHover",mode:"virtual"}),e.jsx(fe,{mode:"multiple",selectAllMode:"allPages"}),e.jsx(de,{allowUpdating:!1,allowAdding:!1,allowDeleting:!1,mode:"batch",confirmDelete:!0,onChangesChange:t=>{}}),e.jsx(Ee,{enabled:!0}),e.jsxs(ue,{disabled:!1,children:[e.jsxs(p,{location:"before",children:[e.jsxs(se,{className:"buttonIcon",onClick:()=>{ne(P,"SPEC DTC")},children:[e.jsx(oe,{color:"green",size:25}),"SAVE"]}),e.jsx("span",{style:{fontSize:20,fontWeight:"bold"},children:"200 đăng ký test gần đây"})]}),e.jsx(p,{name:"searchPanel"}),e.jsx(p,{name:"exportButton"}),e.jsx(p,{name:"columnChooserButton"}),e.jsx(p,{name:"addRowButton"}),e.jsx(p,{name:"saveButton"}),e.jsx(p,{name:"revertButton"})]}),e.jsx(he,{visible:!0}),e.jsx(Te,{visible:!0}),e.jsx(Ce,{enabled:!0}),e.jsx(xe,{defaultPageSize:15}),e.jsx(_e,{showPageSizeSelector:!0,allowedPageSizes:[5,10,15,20,100,1e3,1e4,"all"],showNavigationButtons:!0,showInfo:!0,infoText:"Page #{0}. Total: {1} ({2} items)",displayMode:"compact"}),e.jsx(r,{dataField:"DTC_ID",caption:"DTC_ID",width:100}),e.jsx(r,{dataField:"REQUEST_DATETIME",caption:"REQUEST_DATETIME",width:100}),e.jsx(r,{dataField:"REQUEST_EMPL_NO",caption:"REQUEST_EMPL_NO",width:100}),e.jsx(r,{dataField:"FACTORY",caption:"FACTORY",width:100}),e.jsx(r,{dataField:"TEST_FINISH_TIME",caption:"TEST_FINISH_TIME",width:100}),e.jsx(r,{dataField:"TEST_EMPL_NO",caption:"TEST_EMPL_NO",width:100}),e.jsx(r,{dataField:"G_CODE",caption:"G_CODE",width:100}),e.jsx(r,{dataField:"PROD_REQUEST_NO",caption:"PROD_REQUEST_NO",width:100}),e.jsx(r,{dataField:"G_NAME",caption:"G_NAME",width:100}),e.jsx(r,{dataField:"TEST_NAME",caption:"TEST_NAME",width:100}),e.jsx(r,{dataField:"TEST_TYPE_NAME",caption:"TEST_TYPE_NAME",width:100}),e.jsx(r,{dataField:"WORK_POSITION_NAME",caption:"WORK_POSITION_NAME",width:100}),e.jsx(r,{dataField:"M_NAME",caption:"M_NAME",width:100}),e.jsx(r,{dataField:"SIZE",caption:"SIZE",width:100}),e.jsx(r,{dataField:"REMARK",caption:"REMARK",width:100}),e.jsx(r,{dataField:"LOTCMS",caption:"LOTCMS",width:100})]})}),[P]),F=()=>{j("loadrecentRegisteredDTCData",{}).then(t=>{if(t.data.tk_status!=="NG"){const a=t.data.data.map((i,T)=>({...i,TEST_FINISH_TIME:i.TEST_FINISH_TIME==="1900-01-01T00:00:00.000Z"||i.TEST_FINISH_TIME===null?"":B(i.TEST_FINISH_TIME).utc().format("YYYY-MM-DD HH:mm:ss"),REQUEST_DATETIME:i.REQUEST_DATETIME==="1900-01-01T00:00:00.000Z"||i.REQUEST_DATETIME===null?"":B(i.REQUEST_DATETIME).utc().format("YYYY-MM-DD HH:mm:ss"),id:T}));I(a)}}).catch(t=>{console.log(t)})},X=t=>{j("checkEMPL_NO_mobile",{EMPL_NO:t}).then(a=>{a.data.tk_status!=="NG"?(N(a.data.data[0].MIDLAST_NAME+" "+a.data.data[0].FIRST_NAME),u(a.data.data[0].WORK_POSITION_CODE)):(N(""),u(""))}).catch(a=>{console.log(a)})},l=t=>{j("ycsx_fullinfo",{PROD_REQUEST_NO:t}).then(a=>{a.data.tk_status!=="NG"?(U(t),_(a.data.data[0].G_NAME),A(a.data.data[0].PROD_REQUEST_DATE),L(a.data.data[0].G_CODE),Z("",a.data.data[0].G_CODE)):(U(""),_(""),A(""),L(""))}).catch(a=>{console.log(a)})},J=t=>{j("checkMNAMEfromLotI222",{M_LOT_NO:t}).then(a=>{a.data.tk_status!=="NG"?(q(a.data.data[0].M_NAME+" | "+a.data.data[0].WIDTH_CD),W(a.data.data[0].M_CODE),Z(a.data.data[0].M_CODE,"")):(q(""),W(""))}).catch(a=>{console.log(a)})},V=async()=>{let t=0;return await j("getLastDTCID",{}).then(a=>{a.data.tk_status!=="NG"&&(t=a.data.data[0].LAST_DCT_ID+1)}).catch(a=>{console.log(a)}),t},ee=t=>{j("checkLabelID2",{LABEL_ID2:t}).then(a=>{a.data.tk_status!=="NG"?(U(a.data.data[0].PROD_REQUEST_NO),_(a.data.data[0].G_NAME),A(a.data.data[0].PROD_REQUEST_DATE),L(a.data.data[0].G_CODE),Z("",a.data.data[0].G_CODE)):(U(""),_(""),A(""),L(""))}).catch(a=>{console.log(a)})},De=async()=>{let t="",a=await V();for(let i=0;i<w.length;i++)if(w[i].SELECTED){let T={DTC_ID:a,TEST_CODE:w[i].TEST_CODE,TEST_TYPE_CODE:d,REQUEST_DEPT_CODE:k,PROD_REQUEST_NO:D?"1IG0008":G,M_LOT_NO:D?x:"2101011325",PROD_REQUEST_DATE:D?"20210916":o,REQUEST_EMPL_NO:R,REMARK:v,G_CODE:D?"7A07540A":K,M_CODE:D?m:"B0000035"};await j("registerDTCTest",T).then(g=>{g.data.tk_status!=="NG"||(t+="Lỗi: "+g.data.message+" ")}).catch(g=>{console.log(g)})}t===""?(f.fire("Thông báo","Đăng ký ĐTC thành công, ID test là: "+a,"success"),L(""),_(""),M(""),F()):f.fire("Thông báo","Đăng ký ĐTC thất bại: "+t,"error")},Q=()=>x!==""&&R!=="",Z=(t,a)=>{j("checkAddedSpec",{M_CODE:D?t:"B0000035",G_CODE:D?"7A07540A":a}).then(i=>{i.data.tk_status!=="NG"&&$(i.data.data)}).catch(i=>{console.log(i)})};return s.useEffect(()=>{F()},[]),e.jsx("div",{className:"dkdtc",children:e.jsx("div",{className:"tracuuDataInspection",children:e.jsxs("div",{className:"maintable",children:[e.jsxs("div",{className:"tracuuDataInspectionform",children:[e.jsx("b",{style:{color:"blue"},children:D?"ĐĂNG KÝ TEST LIỆU (IQC)":"ĐĂNG KÝ TEST SẢN PHẨM (PQC/OQC)"}),e.jsxs("div",{className:"forminput",children:[e.jsxs("div",{className:"forminputcolumn",children:[e.jsx("b",{children:"Phân loại test"}),e.jsx("label",{children:e.jsxs("select",{name:"phanloaihang",value:d,onChange:t=>{C(t.target.value)},children:[e.jsx("option",{value:"1",children:"FIRST_LOT"}),e.jsx("option",{value:"2",children:"ECN"}),e.jsx("option",{value:"3",children:"MASS PRODUCTION"}),e.jsx("option",{value:"4",children:"SAMPLE"})]})}),e.jsx("b",{children:D?"LOT NVL CMS":"YCSX/LABEL_ID"})," ",e.jsx("label",{children:e.jsx("input",{type:"text",placeholder:D?"202304190123":"1F80008/13AB19S5",value:x,onChange:t=>{t.target.value.length>=7?D?(console.log(t.target.value),J(t.target.value)):t.target.value.length===7?l(t.target.value):t.target.value.length===8&&ee(t.target.value):$([]),c(t.target.value)}})}),e.jsx("span",{style:{fontSize:15,fontWeight:"bold",color:"blue"},children:D?H:h}),e.jsx("b",{children:"Mã nhân viên yêu cầu test"}),e.jsx("label",{children:e.jsx("input",{type:"text",placeholder:"NVD1201",value:R,onChange:t=>{t.target.value.length>=7&&X(t.target.value),M(t.target.value)}})}),e.jsx("span",{style:{fontSize:15,fontWeight:"bold",color:"blue"},children:y})]}),e.jsxs("div",{className:"forminputcolumn",children:[e.jsx("b",{children:"Hạng mục test"}),e.jsx("label",{children:e.jsx("div",{className:"checkboxarray",children:w.map((t,a)=>{var i,T;return e.jsx(Le,{style:{fontSize:5},label:e.jsx(Fe,{style:{fontSize:13,color:((i=z[a])==null?void 0:i.CHECKADDED)===null||((T=z[a])==null?void 0:T.CHECKADDED)===void 0?"black":"blue"},children:t.TEST_NAME}),sx:{fontSize:5},control:e.jsx(Ve,{classes:{root:"custom-checkbox-root"},name:t.TEST_CODE,checked:t.SELECTED,onChange:g=>{if(z.filter((Se,te)=>Se.TEST_CODE.toString()===g.target.name)[0].CHECKADDED===null)f.fire("Thông báo","Hạng mục "+t.TEST_NAME+" chưa add spec ko thể đăng ký test được, hãy add spec trước","error");else{let Se=w.map((te,wt)=>te.TEST_CODE===g.target.name?{...te,SELECTED:!te.SELECTED}:{...te});O(Se)}}},t.TEST_CODE)},a)})})})]}),e.jsx("div",{className:"forminputcolumn",children:e.jsxs("label",{children:[e.jsx("b",{children:"Remark"}),e.jsx("input",{type:"text",placeholder:"Ghi chú",value:v,onChange:t=>{E(t.target.value)}})]})})]}),e.jsxs("div",{className:"formbutton",children:[e.jsxs("label",{children:[e.jsxs("b",{children:["Swap",":"]}),e.jsx("input",{type:"checkbox",name:"alltimecheckbox",defaultChecked:D,onChange:()=>{S(!D)}})]}),e.jsx("button",{className:"tranhatky",onClick:()=>{O(t=>t.map(a=>({...a,SELECTED:!1})))},children:"Reset hạng mục"}),e.jsx("button",{className:"tranhatky",onClick:()=>{Q()?De():f.fire("Thông báo","Hãy nhập đủ thông tin trước khi đăng ký","error")},children:"Đăng ký TEST"})]}),e.jsx("div",{className:"formbutton",style:{marginTop:"20px",display:"flex",flexWrap:"wrap"}})]}),e.jsx("div",{className:"tracuuYCSXTable",children:b})]})})})};const Rt=()=>{const[n,d]=s.useState(!1);s.useState({trapo:!0,thempohangloat:!1,them1po:!1,them1invoice:!1,themycsx:!1,suaycsx:!1,inserttableycsx:!1,renderycsx:!1,renderbanve:!1,amazontab:!1});const[C,x]=s.useState(!1),[c,D]=s.useState(B().format("YYYY-MM-DD")),[S,R]=s.useState(B().format("YYYY-MM-DD")),[M,v]=s.useState(""),[E,w]=s.useState(""),[O,P]=s.useState("0"),[I,y]=s.useState("0"),[N,k]=s.useState(""),[u,h]=s.useState(!1),[_,K]=s.useState(""),[L,H]=s.useState([]),[q,m]=s.useState(""),[W,G]=s.useState(""),[U,o]=s.useState(""),A=[{field:"DTC_ID",headerName:"DTC_ID",width:80},{field:"PROD_REQUEST_NO",headerName:"YCSX",width:80},{field:"G_CODE",headerName:"G_CODE",width:80},{field:"G_NAME",headerName:"G_NAME",width:200,renderCell:l=>l.row.M_CODE!=="B0000035"?e.jsx("span",{}):e.jsx("span",{children:e.jsx("b",{children:l.row.G_NAME})})},{field:"M_CODE",headerName:"M_CODE",width:80,renderCell:l=>l.row.M_CODE==="B0000035"?e.jsx("span",{}):e.jsx("span",{children:e.jsx("b",{children:l.row.M_CODE})})},{field:"M_NAME",headerName:"TEN LIEU",width:150,renderCell:l=>l.row.M_CODE==="B0000035"?e.jsx("span",{}):e.jsx("span",{children:e.jsx("b",{children:l.row.M_NAME})})},{field:"TEST_NAME",headerName:"TEST_NAME",width:80},{field:"POINT_CODE",headerName:"POINT_CODE",width:90},{field:"CENTER_VALUE",headerName:"CENTER_VALUE",width:120,renderCell:l=>e.jsx("span",{children:e.jsx("b",{children:l.row.CENTER_VALUE})})},{field:"UPPER_TOR",headerName:"UPPER_TOR",width:80,renderCell:l=>e.jsx("span",{children:e.jsx("b",{children:l.row.UPPER_TOR})})},{field:"LOWER_TOR",headerName:"LOWER_TOR",width:80,renderCell:l=>e.jsx("span",{children:e.jsx("b",{children:l.row.LOWER_TOR})})},{field:"RESULT",headerName:"RESULT",width:80},{field:"DANHGIA",headerName:"DANH_GIA",width:80,renderCell:l=>l.row.RESULT>=l.row.CENTER_VALUE-l.row.LOWER_TOR&&l.row.RESULT<=l.row.CENTER_VALUE+l.row.UPPER_TOR?e.jsx("span",{style:{color:"green"},children:e.jsx("b",{children:"OK"})}):e.jsx("span",{style:{color:"red"},children:e.jsx("b",{children:"NG"})})},{field:"FACTORY",headerName:"FACTORY",width:80},{field:"TEST_FINISH_TIME",headerName:"TEST_FINISH_TIME",width:145},{field:"TEST_EMPL_NO",headerName:"NV TEST",width:100},{field:"TEST_TYPE_NAME",headerName:"TEST_TYPE_NAME",width:140},{field:"WORK_POSITION_NAME",headerName:"BO PHAN",width:80},{field:"SAMPLE_NO",headerName:"SAMPLE_NO",width:80},{field:"REQUEST_DATETIME",headerName:"NGAY YC",width:145},{field:"REQUEST_EMPL_NO",headerName:"NV YC",width:80},{field:"SIZE",headerName:"SIZE",width:80},{field:"LOTCMS",headerName:"LOTCMS",width:80},{field:"TEST_CODE",headerName:"TEST_CODE",width:80},{field:"TDS",headerName:"TDS",width:80},{field:"TDS_EMPL",headerName:"TDS_EMPL",width:80},{field:"TDS_UPD_DATE",headerName:"TDS_UPD_DATE",width:80}],[z,$]=s.useState(A);function b(){return e.jsxs($e,{children:[e.jsxs(se,{className:"buttonIcon",onClick:()=>{ne(L,"Inspection Data Table")},children:[e.jsx(oe,{color:"green",size:25}),"SAVE"]}),e.jsx("span",{style:{fontWeight:"bold",fontSize:18,paddingLeft:20,color:"blue"},children:q}),e.jsx(qe,{})]})}const F=l=>{l.key==="Enter"&&X()},X=()=>{m(""),x(!0),j("dtcdata",{ALLTIME:u,FROM_DATE:c,TO_DATE:S,G_CODE:E,G_NAME:M,M_NAME:W,M_CODE:U,TEST_NAME:O,PROD_REQUEST_NO:N,TEST_TYPE:I,ID:_}).then(l=>{if(l.data.tk_status!=="NG"){const J=l.data.data.map((V,ee)=>({...V,TEST_FINISH_TIME:B.utc(V.TEST_FINISH_TIME).format("YYYY-MM-DD HH:mm:ss"),REQUEST_DATETIME:B.utc(V.REQUEST_DATETIME).format("YYYY-MM-DD HH:mm:ss"),id:ee}));H(J),d(!0),x(!1),f.fire("Thông báo","Đã load "+l.data.data.length+" dòng","success")}else f.fire("Thông báo","Nội dung: "+l.data.message,"error"),x(!1)}).catch(l=>{console.log(l)})};return s.useEffect(()=>{},[]),e.jsx("div",{className:"kqdtc",children:e.jsxs("div",{className:"tracuuDataInspection",children:[e.jsxs("div",{className:"tracuuDataInspectionform",children:[e.jsxs("div",{className:"forminput",children:[e.jsxs("div",{className:"forminputcolumn",children:[e.jsxs("label",{children:[e.jsx("b",{children:"Từ ngày:"}),e.jsx("input",{onKeyDown:l=>{F(l)},type:"date",value:c.slice(0,10),onChange:l=>D(l.target.value)})]}),e.jsxs("label",{children:[e.jsx("b",{children:"Tới ngày:"})," ",e.jsx("input",{onKeyDown:l=>{F(l)},type:"date",value:S.slice(0,10),onChange:l=>R(l.target.value)})]})]}),e.jsxs("div",{className:"forminputcolumn",children:[e.jsxs("label",{children:[e.jsx("b",{children:"Code KD:"})," ",e.jsx("input",{onKeyDown:l=>{F(l)},type:"text",placeholder:"GH63-xxxxxx",value:M,onChange:l=>v(l.target.value)})]}),e.jsxs("label",{children:[e.jsx("b",{children:"Code CMS:"})," ",e.jsx("input",{onKeyDown:l=>{F(l)},type:"text",placeholder:"7C123xxx",value:E,onChange:l=>w(l.target.value)})]})]}),e.jsxs("div",{className:"forminputcolumn",children:[e.jsxs("label",{children:[e.jsx("b",{children:"Tên Liệu:"})," ",e.jsx("input",{onKeyDown:l=>{F(l)},type:"text",placeholder:"SJ-203020HC",value:W,onChange:l=>G(l.target.value)})]}),e.jsxs("label",{children:[e.jsx("b",{children:"Mã Liệu CMS:"})," ",e.jsx("input",{onKeyDown:l=>{F(l)},type:"text",placeholder:"A123456",value:U,onChange:l=>o(l.target.value)})]})]}),e.jsxs("div",{className:"forminputcolumn",children:[e.jsxs("label",{children:[e.jsx("b",{children:"Hạng mục test"}),e.jsxs("select",{name:"hangmuctest",value:O,onChange:l=>{P(l.target.value)},children:[e.jsx("option",{value:"0",children:"ALL"}),e.jsx("option",{value:"1",children:"Kích thước"}),e.jsx("option",{value:"2",children:"Kéo keo"}),e.jsx("option",{value:"3",children:"XRF"}),e.jsx("option",{value:"4",children:"Điện trở"}),e.jsx("option",{value:"5",children:"Tĩnh điện"}),e.jsx("option",{value:"6",children:"Độ bóng"}),e.jsx("option",{value:"7",children:"Phtalate"}),e.jsx("option",{value:"8",children:"FTIR"}),e.jsx("option",{value:"9",children:"Mài mòn"}),e.jsx("option",{value:"10",children:"Màu sắc"}),e.jsx("option",{value:"11",children:"TVOC"}),e.jsx("option",{value:"12",children:"Cân nặng"}),e.jsx("option",{value:"13",children:"Scanbarcode"}),e.jsx("option",{value:"14",children:"Nhiệt cao Ẩm cao"}),e.jsx("option",{value:"15",children:"Shock nhiệt"}),e.jsx("option",{value:"1002",children:"Kéo keo 2"}),e.jsx("option",{value:"1003",children:"Ngoại quan"}),e.jsx("option",{value:"1005",children:"Độ dày"})]})]}),e.jsxs("label",{children:[e.jsx("b",{children:"Số YCSX:"})," ",e.jsx("input",{onKeyDown:l=>{F(l)},type:"text",placeholder:"1H23456",value:N,onChange:l=>k(l.target.value)})]})]}),e.jsxs("div",{className:"forminputcolumn",children:[e.jsxs("label",{children:[e.jsx("b",{children:"Phân loại test"}),e.jsxs("select",{name:"phanloaihang",value:I,onChange:l=>{y(l.target.value)},children:[e.jsx("option",{value:"0",children:"ALL"}),e.jsx("option",{value:"1",children:"FIRST_LOT"}),e.jsx("option",{value:"2",children:"ECN"}),e.jsx("option",{value:"3",children:"MASS PRODUCTION"}),e.jsx("option",{value:"4",children:"SAMPLE"})]})]}),e.jsxs("label",{children:[e.jsx("b",{children:"DTC ID:"})," ",e.jsx("input",{onKeyDown:l=>{F(l)},type:"text",placeholder:"12345",value:_,onChange:l=>K(l.target.value)})]})]})]}),e.jsxs("div",{className:"formbutton",children:[e.jsxs("label",{children:[e.jsx("b",{children:"All Time:"}),e.jsx("input",{onKeyDown:l=>{F(l)},type:"checkbox",name:"alltimecheckbox",defaultChecked:u,onChange:()=>h(!u)})]}),e.jsx("button",{className:"tranhatky",onClick:()=>{x(!0),d(!1),$(A),X()},children:"Data DTC"})]})]}),e.jsx("div",{className:"tracuuYCSXTable",children:n&&e.jsx(Qe,{sx:{fontSize:"0.7rem",flex:1},components:{Toolbar:b,LoadingOverlay:We},loading:C,rowHeight:30,rows:L,columns:A,rowsPerPageOptions:[5,10,50,100,500,1e3,5e3,1e4,5e5],editMode:"row"})})]})})};const At=()=>{const[n,d]=s.useState(B().format("YYYY-MM-DD")),[C,x]=s.useState(B().format("YYYY-MM-DD")),[c,D]=s.useState(""),[S,R]=s.useState(""),[M,v]=s.useState("0"),[E,w]=s.useState("0"),[O,P]=s.useState(""),[I,y]=s.useState(!1),[N,k]=s.useState(""),[u,h]=s.useState([]),[_,K]=s.useState(""),[L,H]=s.useState(""),[q,m]=s.useState(0),W=le.useMemo(()=>e.jsx("div",{className:"datatb",children:e.jsxs(ie,{style:{fontSize:"0.8rem"},width:"100%",autoNavigateToFocusedRow:!0,allowColumnReordering:!0,allowColumnResizing:!0,columnAutoWidth:!1,cellHintEnabled:!0,columnResizingMode:"widget",showColumnLines:!0,dataSource:u,columnWidth:"auto",keyExpr:"id",height:"100%",showBorders:!0,onSelectionChanged:o=>{m(o.selectedRowsData.length)},onRowClick:o=>{},children:[e.jsx(re,{editOnKeyPress:!0,enterKeyAction:"moveFocus",enterKeyDirection:"column"}),e.jsx(ce,{useNative:!0,scrollByContent:!0,scrollByThumb:!0,showScrollbar:"onHover",mode:"virtual"}),e.jsx(fe,{mode:"multiple",selectAllMode:"allPages"}),e.jsx(de,{allowUpdating:!1,allowAdding:!0,allowDeleting:!1,mode:"batch",confirmDelete:!0,onChangesChange:o=>{}}),e.jsx(Ee,{enabled:!0}),e.jsxs(ue,{disabled:!1,children:[e.jsx(p,{location:"before",children:e.jsxs(se,{className:"buttonIcon",onClick:()=>{ne(u,"SPEC DTC")},children:[e.jsx(oe,{color:"green",size:25}),"SAVE"]})}),e.jsx(p,{name:"searchPanel"}),e.jsx(p,{name:"exportButton"}),e.jsx(p,{name:"columnChooser"})]}),e.jsx(he,{visible:!0}),e.jsx(Te,{visible:!0}),e.jsx(Ce,{enabled:!0}),e.jsx(xe,{defaultPageSize:15}),e.jsx(_e,{showPageSizeSelector:!0,allowedPageSizes:[5,10,15,20,100,1e3,1e4,"all"],showNavigationButtons:!0,showInfo:!0,infoText:"Page #{0}. Total: {1} ({2} items)",displayMode:"compact"}),e.jsx(r,{dataField:"CUST_NAME_KD",caption:"CUST_NAME_KD",width:100}),e.jsx(r,{dataField:"G_CODE",caption:"G_CODE",width:100}),e.jsx(r,{dataField:"G_NAME",caption:"G_NAME",width:150}),e.jsx(r,{dataField:"TEST_NAME",caption:"TEST_NAME",width:100}),e.jsx(r,{dataField:"POINT_NAME",caption:"POINT_NAME",width:100}),e.jsx(r,{dataField:"PRI",caption:"PRI",width:100}),e.jsx(r,{dataField:"CENTER_VALUE",caption:"CENTER_VALUE",width:120}),e.jsx(r,{dataField:"UPPER_TOR",caption:"UPPER_TOR",width:120}),e.jsx(r,{dataField:"LOWER_TOR",caption:"LOWER_TOR",width:120}),e.jsx(r,{dataField:"MIN_SPEC",caption:"MIN_SPEC",width:120}),e.jsx(r,{dataField:"MAX_SPEC",caption:"MAX_SPEC",width:120}),e.jsx(r,{dataField:"BARCODE_CONTENT",caption:"BARCODE_CONTENT",width:100}),e.jsx(r,{dataField:"REMARK",caption:"REMARK",width:100}),e.jsx(r,{dataField:"M_NAME",caption:"M_NAME",width:120}),e.jsx(r,{dataField:"WIDTH_CD",caption:"WIDTH_CD",width:100}),e.jsx(r,{dataField:"M_CODE",caption:"M_CODE",width:100}),e.jsx(r,{caption:"BANVE",width:150,cellRender:o=>{if(o.data.M_CODE==="B0000035"){let A=`/banve/${o.data.G_CODE}.pdf`;return o.data.BANVE==="Y"?e.jsx("div",{style:{color:"white",fontWeight:"bold",height:"20px",width:"80px",backgroundColor:"#54e00d",textAlign:"center"},children:e.jsx("a",{href:A,target:"_blank",rel:"noopener noreferrer",children:"Bản Vẽ"})}):e.jsx("div",{style:{color:"white",fontWeight:"bold",height:"20px",width:"80px",backgroundColor:"gray",textAlign:"center"},children:"Chưa có bản vẽ"})}else{let A=`/tds/${o.data.M_CODE}.pdf`;return o.data.TDS==="Y"?e.jsx("div",{style:{color:"white",fontWeight:"bold",height:"20px",width:"80px",backgroundColor:"red",textAlign:"center"},children:e.jsx("a",{href:A,target:"_blank",rel:"noopener noreferrer",children:"TDS"})}):e.jsx("div",{style:{color:"white",fontWeight:"bold",height:"20px",width:"80px",backgroundColor:"gray",textAlign:"center"},children:"Chưa có TDS"})}}}),e.jsx(ye,{children:e.jsx(ke,{alignment:"right",column:"G_CODE",summaryType:"count",valueFormat:"decimal"})})]})}),[u]),G=o=>{o.key==="Enter"&&U()},U=()=>{f.fire({title:"Tra cứu SPEC Vật liệu - Sản phẩm",text:"Đang tải dữ liệu, hãy chờ chút",icon:"info",showCancelButton:!1,allowOutsideClick:!1,confirmButtonText:"OK",showConfirmButton:!1}),j("dtcspec",{ALLTIME:I,FROM_DATE:n,TO_DATE:C,G_CODE:S,G_NAME:c,M_NAME:_,M_CODE:L,TEST_NAME:M,PROD_REQUEST_NO:O,TEST_TYPE:E,ID:N}).then(o=>{if(o.data.tk_status!=="NG"){const A=o.data.data.map((z,$)=>({...z,id:$}));h(A),f.fire("Thông báo","Đã load "+o.data.data.length+" dòng","success")}else f.fire("Thông báo","Nội dung: "+o.data.message,"error")}).catch(o=>{console.log(o)})};return s.useEffect(()=>{},[]),e.jsx("div",{className:"specdtc",children:e.jsxs("div",{className:"tracuuDataInspection",children:[e.jsxs("div",{className:"tracuuDataInspectionform",children:[e.jsxs("div",{className:"forminput",children:[e.jsxs("div",{className:"forminputcolumn",children:[e.jsxs("label",{children:[e.jsx("b",{children:"Code KD:"})," ",e.jsx("input",{onKeyDown:o=>{G(o)},type:"text",placeholder:"GH63-xxxxxx",value:c,onChange:o=>D(o.target.value)})]}),e.jsxs("label",{children:[e.jsx("b",{children:"Code CMS:"})," ",e.jsx("input",{onKeyDown:o=>{G(o)},type:"text",placeholder:"7C123xxx",value:S,onChange:o=>R(o.target.value)})]})]}),e.jsxs("div",{className:"forminputcolumn",children:[e.jsxs("label",{children:[e.jsx("b",{children:"Tên Liệu:"})," ",e.jsx("input",{onKeyDown:o=>{G(o)},type:"text",placeholder:"SJ-203020HC",value:_,onChange:o=>K(o.target.value)})]}),e.jsxs("label",{children:[e.jsx("b",{children:"Mã Liệu CMS:"})," ",e.jsx("input",{onKeyDown:o=>{G(o)},type:"text",placeholder:"A123456",value:L,onChange:o=>H(o.target.value)})]})]}),e.jsxs("div",{className:"forminputcolumn",children:[e.jsxs("label",{children:[e.jsx("b",{children:"Hạng mục test"}),e.jsxs("select",{name:"hangmuctest",value:M,onChange:o=>{v(o.target.value)},children:[e.jsx("option",{value:"0",children:"ALL"}),e.jsx("option",{value:"1",children:"Kích thước"}),e.jsx("option",{value:"2",children:"Kéo keo"}),e.jsx("option",{value:"3",children:"XRF"}),e.jsx("option",{value:"4",children:"Điện trở"}),e.jsx("option",{value:"5",children:"Tĩnh điện"}),e.jsx("option",{value:"6",children:"Độ bóng"}),e.jsx("option",{value:"7",children:"Phtalate"}),e.jsx("option",{value:"8",children:"FTIR"}),e.jsx("option",{value:"9",children:"Mài mòn"}),e.jsx("option",{value:"10",children:"Màu sắc"}),e.jsx("option",{value:"11",children:"TVOC"}),e.jsx("option",{value:"12",children:"Cân nặng"}),e.jsx("option",{value:"13",children:"Scanbarcode"}),e.jsx("option",{value:"14",children:"Nhiệt cao Ẩm cao"}),e.jsx("option",{value:"15",children:"Shock nhiệt"}),e.jsx("option",{value:"1002",children:"Kéo keo 2 mặt"})]})]}),e.jsxs("label",{children:[e.jsx("b",{children:"Số YCSX:"})," ",e.jsx("input",{onKeyDown:o=>{G(o)},type:"text",placeholder:"1H23456",value:O,onChange:o=>P(o.target.value)})]})]}),e.jsx("div",{className:"forminputcolumn"})]}),e.jsxs("div",{className:"formbutton",children:[e.jsxs("label",{children:[e.jsx("b",{children:"All Time:"}),e.jsx("input",{onKeyDown:o=>{G(o)},type:"checkbox",name:"alltimecheckbox",defaultChecked:I,onChange:()=>y(!I)})]}),e.jsx("button",{className:"tranhatky",onClick:()=>{U()},children:"Spec DTC"})]})]}),e.jsx("div",{className:"tracuuYCSXTable",children:W})]})})};const Mt=()=>{const[n,d]=s.useState([]),[C,x]=s.useState([{M_CODE:"A0000001",M_NAME:"#200",WIDTH_CD:1200}]),[c,D]=s.useState({M_CODE:"A0000001",M_NAME:"#200",WIDTH_CD:1200}),[S,R]=s.useTransition(),[M,v]=s.useState([]),[E,w]=s.useState({G_CODE:"7C03925A",G_NAME:"GH63-18084A_A_SM-A515F",PROD_LAST_PRICE:.318346,USE_YN:"Y"}),O=Ie(t=>t.totalSlice.userData),[P,I]=s.useState(B().format("YYYY-MM-DD")),[y,N]=s.useState(B().format("YYYY-MM-DD")),[k,u]=s.useState("");s.useState("");const[h,_]=s.useState("0"),[K,L]=s.useState("0"),[H,q]=s.useState(""),[m,W]=s.useState((O==null?void 0:O.SUBDEPTNAME)==="IQC"),[G,U]=s.useState(""),[o,A]=s.useState([]),[z,$]=s.useState(""),[b,F]=s.useState([]),X=t=>{j("selectcodeList",{G_NAME:t}).then(a=>{a.data.tk_status!=="NG"&&(S||R(()=>{v(a.data.data)}))}).catch(a=>{console.log(a)})},l=()=>{j("getMaterialList",{}).then(t=>{t.data.tk_status!=="NG"&&x(t.data.data)}).catch(t=>{console.log(t)})},J=le.useMemo(()=>e.jsx("div",{className:"datatb",children:e.jsxs(ie,{style:{fontSize:"0.7rem"},autoNavigateToFocusedRow:!0,allowColumnReordering:!0,allowColumnResizing:!0,columnAutoWidth:!1,cellHintEnabled:!0,columnResizingMode:"widget",showColumnLines:!0,dataSource:o,columnWidth:"auto",keyExpr:"id",height:"71vh",showBorders:!0,onSelectionChanged:t=>{F(t.selectedRowsData)},onRowClick:t=>{},children:[e.jsx(re,{editOnKeyPress:!0,enterKeyAction:"moveFocus",enterKeyDirection:"column"}),e.jsx(ce,{useNative:!0,scrollByContent:!0,scrollByThumb:!0,showScrollbar:"onHover",mode:"virtual"}),e.jsx(fe,{mode:"multiple",selectAllMode:"allPages"}),e.jsx(de,{allowUpdating:!0,allowAdding:!1,allowDeleting:!0,mode:"cell",confirmDelete:!1,onChangesChange:t=>{}}),e.jsx(Ee,{enabled:!0}),e.jsxs(ue,{disabled:!1,children:[e.jsx(p,{location:"before",children:e.jsxs(se,{className:"buttonIcon",onClick:()=>{ne(o,"SPEC DTC")},children:[e.jsx(oe,{color:"green",size:25}),"SAVE"]})}),e.jsx(p,{name:"searchPanel"}),e.jsx(p,{name:"exportButton"}),e.jsx(p,{name:"columnChooserButton"}),e.jsx(p,{name:"addRowButton"}),e.jsx(p,{name:"saveButton"}),e.jsx(p,{name:"revertButton"})]}),e.jsx(he,{visible:!0}),e.jsx(Te,{visible:!0}),e.jsx(Ce,{enabled:!0}),e.jsx(xe,{defaultPageSize:15}),e.jsx(_e,{showPageSizeSelector:!0,allowedPageSizes:[5,10,15,20,100,1e3,1e4,"all"],showNavigationButtons:!0,showInfo:!0,infoText:"Page #{0}. Total: {1} ({2} items)",displayMode:"compact"}),e.jsx(r,{dataField:"TEST_NAME",caption:"TEST_NAME"}),e.jsx(r,{dataField:"POINT_NAME",caption:"POINT_NAME"}),e.jsx(r,{dataField:"PRI",caption:"PRI"}),e.jsx(r,{dataField:"CENTER_VALUE",caption:"CENTER_VALUE",width:120}),e.jsx(r,{dataField:"UPPER_TOR",caption:"UPPER_TOR",width:120}),e.jsx(r,{dataField:"LOWER_TOR",caption:"LOWER_TOR",width:120}),e.jsx(r,{dataField:"BARCODE_CONTENT",caption:"BARCODE_CONTENT"}),e.jsx(r,{dataField:"REMARK",caption:"REMARK"}),e.jsx(r,{dataField:"M_NAME",caption:"M_NAME",width:120}),e.jsx(r,{dataField:"WIDTH_CD",caption:"WIDTH_CD"}),e.jsx(r,{dataField:"M_CODE",caption:"M_CODE"}),e.jsx(r,{caption:"BANVE/TDS",width:150,cellRender:t=>{if(t.data.M_CODE==="B0000035"){let a=`/banve/${t.data.G_CODE}.pdf`;return t.data.BANVE==="Y"?e.jsx("div",{style:{color:"white",fontWeight:"bold",height:"20px",width:"80px",backgroundColor:"#54e00d",textAlign:"center"},children:e.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",children:"Bản Vẽ"})}):e.jsx("div",{style:{color:"white",fontWeight:"bold",height:"20px",width:"80px",backgroundColor:"gray",textAlign:"center"},children:"Chưa có bản vẽ"})}else{let a=`/tds/${t.data.M_CODE}.pdf`;return t.data.TDS==="Y"?e.jsx("div",{style:{color:"white",fontWeight:"bold",height:"20px",width:"80px",backgroundColor:"#54e00d",textAlign:"center"},children:e.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",children:"TDS"})}):e.jsx("div",{style:{color:"white",fontWeight:"bold",height:"20px",width:"80px",backgroundColor:"gray",textAlign:"center"},children:"Chưa có TDS"})}}}),e.jsx(r,{dataField:"CUST_NAME_KD",caption:"CUST_NAME_KD"}),e.jsx(r,{dataField:"G_CODE",caption:"G_CODE"}),e.jsx(r,{dataField:"G_NAME",caption:"G_NAME",width:150}),e.jsx(ye,{children:e.jsx(ke,{alignment:"right",column:"G_CODE",summaryType:"count",valueFormat:"decimal"})})]})}),[o]),V=t=>{j("checkSpecDTC",{checkNVL:m,FROM_DATE:P,TO_DATE:y,G_CODE:m===!0?"":E==null?void 0:E.G_CODE,G_NAME:k,M_NAME:z,M_CODE:m===!0?c==null?void 0:c.M_CODE:"",TEST_NAME:t,PROD_REQUEST_NO:H,TEST_TYPE:K,ID:G}).then(a=>{if(a.data.tk_status!=="NG"){const i=a.data.data.map((T,g)=>({...T,id:g}));A(i),f.fire("Thông báo","Đã load "+a.data.data.length+" dòng","success"),Q(c==null?void 0:c.M_CODE,E==null?void 0:E.G_CODE)}else j("checkSpecDTC2",{checkNVL:m,FROM_DATE:P,TO_DATE:y,G_CODE:m===!0?"":E==null?void 0:E.G_CODE,G_NAME:k,M_NAME:z,M_CODE:m===!0?c==null?void 0:c.M_CODE:"",TEST_NAME:t,PROD_REQUEST_NO:H,TEST_TYPE:K,ID:G}).then(i=>{if(i.data.tk_status!=="NG"){const T=i.data.data.map((g,pe)=>({...g,id:pe}));m&&t==="1"?(A([...[],T[0]]),f.fire("Thông báo","Chưa có SPEC, Đã load bảng trắng để nhập 1 dòng","warning")):(A(T),f.fire("Thông báo","Chưa có SPEC, Đã load bảng trắng để nhập "+i.data.data.length+" dòng","warning")),Q(c==null?void 0:c.M_CODE,E==null?void 0:E.G_CODE)}else A([])}).catch(i=>{console.log(i)})}).catch(a=>{console.log(a)})},ee=async()=>{if(f.fire({title:"Insert SPEC",text:"Đang Insert SPEC",icon:"info",showCancelButton:!1,allowOutsideClick:!1,confirmButtonText:"OK",showConfirmButton:!1}),h==="0")f.fire("Thông báo","Hãy chọn một hạng mục test bất kỳ","error");else{if(m){let t=C.filter(i=>i.M_NAME===(c==null?void 0:c.M_NAME)).map(i=>({M_CODE:i.M_CODE,WIDTH_CD:i.WIDTH_CD})),a="";for(let i=0;i<t.length;i++)for(let T=0;T<o.length;T++)await j("insertSpecDTC",{checkNVL:m,G_CODE:"7A07540A",M_CODE:t[i].M_CODE,TEST_CODE:h,POINT_CODE:o[T].POINT_CODE,PRI:o[T].PRI,CENTER_VALUE:h==="1"?t[i].WIDTH_CD:o[T].CENTER_VALUE,UPPER_TOR:o[T].UPPER_TOR,LOWER_TOR:o[T].LOWER_TOR,BARCODE_CONTENT:o[T].BARCODE_CONTENT===void 0?"":o[T].BARCODE_CONTENT,REMARK:o[T].REMARK===void 0?"":o[T].REMARK}).then(g=>{g.data.tk_status!=="NG"||(a+=" Lỗi: "+o[T].TEST_CODE+"| "+o[T].POINT_CODE+" : "+g.data.message)}).catch(g=>{console.log(g)});a!==""?f.fire("Thông báo: ","Có lỗi : "+a,"error"):f.fire("Thông báo: ","Add SPEC thành công","success")}else{let t="";for(let a=0;a<o.length;a++)await j("insertSpecDTC",{checkNVL:m,G_CODE:E==null?void 0:E.G_CODE,M_CODE:"B0000035",TEST_CODE:h,POINT_CODE:o[a].POINT_CODE,PRI:o[a].PRI,CENTER_VALUE:o[a].CENTER_VALUE,UPPER_TOR:o[a].UPPER_TOR,LOWER_TOR:o[a].LOWER_TOR,BARCODE_CONTENT:o[a].BARCODE_CONTENT===void 0?"":o[a].BARCODE_CONTENT,REMARK:o[a].REMARK===void 0?"":o[a].REMARK}).then(i=>{i.data.tk_status!=="NG"||(t+=" Lỗi: "+o[a].TEST_CODE+"| "+o[a].POINT_CODE+" : "+i.data.message)}).catch(i=>{console.log(i)});t!==""?f.fire("Thông báo: ","Có lỗi : "+t,"error"):f.fire("Thông báo: ","Add SPEC thành công","success")}Q(c==null?void 0:c.M_CODE,E==null?void 0:E.G_CODE)}},De=async()=>{if(f.fire({title:"Update SPEC",text:"Đang Update SPEC",icon:"info",showCancelButton:!1,allowOutsideClick:!1,confirmButtonText:"OK",showConfirmButton:!1}),h==="0")f.fire("Thông báo","Hãy chọn một hạng mục test bất kỳ","error");else if(b.length<1)f.fire("Thông báo","Chọn ít nhất một dòng để update","error");else{if(m){let t=C.filter(i=>i.M_NAME===(c==null?void 0:c.M_NAME)).map(i=>({M_CODE:i.M_CODE,WIDTH_CD:i.WIDTH_CD})),a="";for(let i=0;i<t.length;i++)for(let T=0;T<b.length;T++)await j("updateSpecDTC",{checkNVL:m,G_CODE:"7A07540A",M_CODE:t[i].M_CODE,TEST_CODE:h,POINT_CODE:b[T].POINT_CODE,PRI:b[T].PRI,CENTER_VALUE:h==="1"?t[i].WIDTH_CD:b[T].CENTER_VALUE,UPPER_TOR:b[T].UPPER_TOR,LOWER_TOR:b[T].LOWER_TOR,BARCODE_CONTENT:b[T].BARCODE_CONTENT,REMARK:b[T].REMARK}).then(g=>{g.data.tk_status!=="NG"||(a+=" Lỗi: "+o[T].TEST_CODE+"| "+o[T].POINT_CODE+" : "+g.data.message)}).catch(g=>{console.log(g)});a!==""?f.fire("Thông báo: ","Có lỗi : "+a,"error"):f.fire("Thông báo: ","Add SPEC thành công","success")}else{let t="";for(let a=0;a<b.length;a++)await j("updateSpecDTC",{checkNVL:m,G_CODE:E==null?void 0:E.G_CODE,M_CODE:"B0000035",TEST_CODE:h,POINT_CODE:b[a].POINT_CODE,PRI:b[a].PRI,CENTER_VALUE:b[a].CENTER_VALUE,UPPER_TOR:b[a].UPPER_TOR,LOWER_TOR:b[a].LOWER_TOR,BARCODE_CONTENT:b[a].BARCODE_CONTENT,REMARK:b[a].REMARK}).then(i=>{i.data.tk_status!=="NG"||(t+=" Lỗi: "+o[a].TEST_CODE+"| "+o[a].POINT_CODE+" : "+i.data.message)}).catch(i=>{console.log(i)});t!==""?f.fire("Thông báo: ","Có lỗi : "+t,"error"):f.fire("Thông báo: ","Add SPEC thành công","success")}Q(c==null?void 0:c.M_CODE,E==null?void 0:E.G_CODE)}},Q=(t,a)=>{j("checkAddedSpec",{M_CODE:m?t:"B0000035",G_CODE:m?"7A07540A":a}).then(i=>{i.data.tk_status!=="NG"&&d(i.data.data)}).catch(i=>{console.log(i)})},Z=Xe({matchFrom:"any",limit:100});return s.useEffect(()=>{X(""),l()},[]),e.jsx("div",{className:"addspecdtc",children:e.jsxs("div",{className:"tracuuDataInspection",children:[e.jsxs("div",{className:"tracuuDataInspectionform",children:[e.jsx("b",{style:{color:"blue"},children:m?"ADD SPEC ĐTC NVL (IQC)":"ADD SPEC ĐTC SẢN PHẨM (RND)"}),e.jsx("br",{}),e.jsxs("div",{className:"forminput",children:[e.jsx("b",{children:"Chọn sản phẩm/ vật liệu"}),e.jsxs("div",{className:"forminputcolumn",children:[!m&&e.jsx("label",{children:e.jsx(je,{hidden:m,disabled:m,size:"small",disablePortal:!0,options:M,className:"autocomplete",filterOptions:Z,isOptionEqualToValue:(t,a)=>t.G_CODE===a.G_CODE,getOptionLabel:t=>`${t.G_CODE}: ${t.G_NAME}`,renderInput:t=>e.jsx(Ne,{...t}),onChange:(t,a)=>{w(a)},value:E})}),m&&e.jsx("label",{children:e.jsx(je,{hidden:!m,disabled:!m,size:"small",disablePortal:!0,options:C,className:"autocomplete",filterOptions:Z,isOptionEqualToValue:(t,a)=>t.M_CODE===a.M_CODE,getOptionLabel:t=>`${t.M_NAME}|${t.WIDTH_CD}|${t.M_CODE}`,renderInput:t=>e.jsx(Ne,{...t,label:"Chọn NVL"}),defaultValue:{M_CODE:"A0007770",M_NAME:"SJ-203020HC",WIDTH_CD:208},value:c,onChange:(t,a)=>{D(a)}})})]}),e.jsx("b",{children:"Hạng mục test"}),e.jsx("div",{className:"forminputcolumn",children:e.jsx("label",{children:e.jsxs("select",{name:"hangmuctest",value:h,onChange:t=>{_(t.target.value),V(t.target.value),Q(c==null?void 0:c.M_CODE,E==null?void 0:E.G_CODE)},children:[e.jsx("option",{value:"0",children:"ALL"}),e.jsx("option",{value:"1",children:"Kích thước"}),e.jsx("option",{value:"2",children:"Kéo keo"}),e.jsx("option",{value:"3",children:"XRF"}),e.jsx("option",{value:"4",children:"Điện trở"}),e.jsx("option",{value:"5",children:"Tĩnh điện"}),e.jsx("option",{value:"6",children:"Độ bóng"}),e.jsx("option",{value:"7",children:"Phtalate"}),e.jsx("option",{value:"8",children:"FTIR"}),e.jsx("option",{value:"9",children:"Mài mòn"}),e.jsx("option",{value:"10",children:"Màu sắc"}),e.jsx("option",{value:"11",children:"TVOC"}),e.jsx("option",{value:"12",children:"Cân nặng"}),e.jsx("option",{value:"13",children:"Scanbarcode"}),e.jsx("option",{value:"14",children:"Nhiệt cao Ẩm cao"}),e.jsx("option",{value:"15",children:"Shock nhiệt"}),e.jsx("option",{value:"1002",children:"Kéo keo 2"}),e.jsx("option",{value:"1003",children:"Ngoại Quan"}),e.jsx("option",{value:"1005",children:"Độ dày"})]})})}),e.jsx("div",{className:"forminputcolumn"})]}),e.jsxs("div",{className:"formbutton",children:[e.jsx("button",{className:"tranhatky",onClick:()=>{V(h),Q(c==null?void 0:c.M_CODE,E==null?void 0:E.G_CODE)},children:"Load SPEC"}),e.jsx("button",{className:"tranhatky",onClick:()=>{ee()},children:"Add SPEC"}),e.jsx("button",{className:"tranhatky",onClick:()=>{De()},children:"Update SPEC"})]}),e.jsx("div",{className:"formbutton",style:{display:"flex",flexWrap:"wrap",marginTop:"20px",marginBottom:"20px"},children:n.map((t,a)=>e.jsxs("div",{style:{},children:[e.jsxs("span",{style:{fontSize:12},children:[t.TEST_NAME,":"]}),e.jsx("span",{style:{fontSize:12,fontWeight:t.CHECKADDED?"bold":"normal",color:t.CHECKADDED?"blue":"red"},children:t.CHECKADDED?"YES":"NO"})]},a))}),e.jsx("div",{className:"formbutton",children:e.jsxs("label",{children:[e.jsxs("b",{children:[m===!0?"Swap (SP)":"Swap (NVL)",":"]}),e.jsx("input",{type:"checkbox",name:"alltimecheckbox",defaultChecked:m,onChange:()=>{W(!m),d([]),A([])}})]})})]}),e.jsx("div",{className:"tracuuYCSXTable",children:J})]})})};const vt=()=>{s.useState("3"),s.useState(""),s.useState(!1);const[n,d]=s.useState(""),[C,x]=s.useState(""),[c,D]=s.useState([{TEST_CODE:"1",TEST_NAME:"Kích thước",CHECKADDED:!1},{TEST_CODE:"2",TEST_NAME:"Kéo keo",CHECKADDED:!1},{TEST_CODE:"3",TEST_NAME:"XRF",CHECKADDED:!1},{TEST_CODE:"4",TEST_NAME:"Điện trở",CHECKADDED:!1},{TEST_CODE:"5",TEST_NAME:"Tĩnh điện",CHECKADDED:!1},{TEST_CODE:"6",TEST_NAME:"Độ bóng",CHECKADDED:!1},{TEST_CODE:"7",TEST_NAME:"Phtalate",CHECKADDED:!1},{TEST_CODE:"8",TEST_NAME:"FTIR",CHECKADDED:!1},{TEST_CODE:"9",TEST_NAME:"Mài mòn",CHECKADDED:!1},{TEST_CODE:"10",TEST_NAME:"Màu sắc",CHECKADDED:!1},{TEST_CODE:"11",TEST_NAME:"TVOC",CHECKADDED:!1},{TEST_CODE:"12",TEST_NAME:"Cân nặng",CHECKADDED:!1},{TEST_CODE:"13",TEST_NAME:"Scanbarcode",CHECKADDED:!1},{TEST_CODE:"14",TEST_NAME:"Nhiệt cao Ẩm cao",CHECKADDED:!1},{TEST_CODE:"15",TEST_NAME:"Shock nhiệt",CHECKADDED:!1},{TEST_CODE:"1002",TEST_NAME:"Kéo keo 2",CHECKADDED:!1},{TEST_CODE:"1003",TEST_NAME:"Ngoại Quan",CHECKADDED:!1},{TEST_CODE:"1005",TEST_NAME:"Độ dày",CHECKADDED:!1}]),[S,R]=s.useState([]),[M,v]=s.useState("1003");s.useState([]);const[E,w]=s.useState("");s.useState(""),s.useState(""),s.useState(""),s.useState(""),s.useState(""),s.useState(""),s.useState("");const O=le.useMemo(()=>e.jsx("div",{className:"datatb",children:e.jsxs(ie,{style:{fontSize:"0.7rem"},autoNavigateToFocusedRow:!0,allowColumnReordering:!0,allowColumnResizing:!0,columnAutoWidth:!1,cellHintEnabled:!0,columnResizingMode:"widget",showColumnLines:!0,dataSource:S,columnWidth:"auto",keyExpr:"id",height:"71vh",showBorders:!0,onSelectionChanged:u=>{},onRowClick:u=>{},children:[e.jsx(re,{editOnKeyPress:!0,enterKeyAction:"moveFocus",enterKeyDirection:"column"}),e.jsx(ce,{useNative:!0,scrollByContent:!0,scrollByThumb:!0,showScrollbar:"onHover",mode:"virtual"}),e.jsx(de,{allowUpdating:!0,allowAdding:!1,allowDeleting:!1,mode:"cell",confirmDelete:!0,onChangesChange:u=>{}}),e.jsx(Ee,{enabled:!0}),e.jsxs(ue,{disabled:!1,children:[e.jsxs(p,{location:"before",children:[e.jsxs(se,{className:"buttonIcon",onClick:()=>{ne(S,"SPEC DTC")},children:[e.jsx(oe,{color:"green",size:25}),"SAVE"]}),e.jsx("span",{style:{fontSize:20,fontWeight:"bold"},children:"Bảng nhập kết quả độ tin cậy"})]}),e.jsx(p,{name:"searchPanel"}),e.jsx(p,{name:"exportButton"}),e.jsx(p,{name:"columnChooserButton"}),e.jsx(p,{name:"addRowButton"}),e.jsx(p,{name:"saveButton"}),e.jsx(p,{name:"revertButton"})]}),e.jsx(he,{visible:!0}),e.jsx(Te,{visible:!0}),e.jsx(Ce,{enabled:!0}),e.jsx(xe,{defaultPageSize:15}),e.jsx(_e,{showPageSizeSelector:!0,allowedPageSizes:[5,10,15,20,100,1e3,1e4,"all"],showNavigationButtons:!0,showInfo:!0,infoText:"Page #{0}. Total: {1} ({2} items)",displayMode:"compact"}),e.jsx(r,{dataField:"DTC_ID",caption:"DTC_ID",width:100}),e.jsx(r,{dataField:"TEST_NAME",caption:"TEST_NAME",width:100}),e.jsx(r,{dataField:"POINT_NAME",caption:"POINT_NAME",width:100}),e.jsx(r,{dataField:"CENTER_VALUE",caption:"CENTER_VALUE",width:100}),e.jsx(r,{dataField:"UPPER_TOR",caption:"UPPER_TOR",width:100}),e.jsx(r,{dataField:"LOWER_TOR",caption:"LOWER_TOR",width:100}),e.jsx(r,{dataField:"RESULT",caption:"RESULT",width:100}),e.jsx(r,{dataField:"REMARK",caption:"REMARK",width:100})]})}),[S]),P=(u,h)=>{j("getinputdtcspec",{DTC_ID:u,TEST_CODE:h}).then(_=>{if(_.data.tk_status!=="NG"){const K=_.data.data.map((L,H)=>({...L,id:H}));R(K)}else R([])}).catch(_=>{console.log(_)})},I=()=>{let u=!0;for(let h=0;h<S.length;h++)(S[h].RESULT===""||S[h].RESULT===null)&&(u=!1);return n!==""&&u===!0},y=u=>{j("checkRegisterdDTCTEST",{DTC_ID:u}).then(h=>{if(h.data.tk_status!=="NG"){let _=h.data.data.map((K,L)=>({...K,CHECKADDED:K.CHECKADDED!==null}));D(_)}}).catch(h=>{console.log(h)})},N=async()=>{if(S.length>0){let u="";for(let h=0;h<S.length;h++)await j("insert_dtc_result",{DTC_ID:n,G_CODE:S[h].G_CODE,M_CODE:S[h].M_CODE,TEST_CODE:S[h].TEST_CODE,POINT_CODE:S[h].POINT_CODE,SAMPLE_NO:1,RESULT:S[h].RESULT,REMARK:C}).then(_=>{_.data.tk_status!=="NG"||(u+="Lỗi : "+_.data.message)}).catch(_=>{console.log(_)});u===""?(k(S[0].DTC_ID,S[0].TEST_CODE),f.fire("Thông báo","Up kết quả thành công","success")):f.fire("Thông báo","Lỗi: "+u,"error")}},k=(u,h)=>{j("updateDTC_TEST_EMPL",{DTC_ID:u,TEST_CODE:h}).then(_=>{_.data.tk_status}).catch(_=>{console.log(_)})};return s.useEffect(()=>{},[]),e.jsx("div",{className:"dtcresult",children:e.jsx("div",{className:"tracuuDataInspection",children:e.jsxs("div",{className:"maintable",children:[e.jsxs("div",{className:"tracuuDataInspectionform",children:[e.jsx("b",{style:{color:"blue"},children:"NHẬP KẾT QUẢ ĐỘ TIN CẬY"}),e.jsxs("div",{className:"forminput",children:[e.jsx("div",{className:"forminputcolumn",children:e.jsxs("label",{children:[e.jsx("b",{children:"ID Test Độ Tin Cậy"}),e.jsx("input",{type:"text",placeholder:"123456",value:n,onChange:u=>{d(u.target.value),y(u.target.value)}}),e.jsx("span",{style:{fontSize:15,fontWeight:"bold",color:"blue"},children:E})]})}),e.jsx("div",{className:"forminputcolumn",children:e.jsxs("label",{children:[e.jsx("b",{children:"Hạng mục test"}),e.jsx("div",{className:"checkboxarray",style:{display:"flex"},children:e.jsx(Ot,{"aria-labelledby":"demo-controlled-radio-buttons-group",name:"controlled-radio-buttons-group",value:M,onChange:u=>{console.log(u.target.value),v(u.target.value),n!==""&&P(n,u.target.value)},style:{display:"flex"},children:e.jsx("div",{className:"radiogroup",style:{display:"flex",flexWrap:"wrap"},children:c.map((u,h)=>e.jsx("div",{className:"radioelement",style:{display:"flex",margin:0,padding:0},children:e.jsx(Le,{value:u.TEST_CODE.toString(),style:{fontSize:5},label:e.jsx(Fe,{style:{fontSize:12,fontWeight:u.CHECKADDED?"bold":"normal",color:u.CHECKADDED?"green":"black"},children:u.TEST_NAME}),sx:{fontSize:5},control:e.jsx(jt,{})},h)},h))})})})]})}),e.jsx("div",{className:"forminputcolumn",children:e.jsxs("label",{children:[e.jsx("b",{children:"Remark"}),e.jsx("input",{type:"text",placeholder:"Ghi chú",value:C,onChange:u=>{x(u.target.value)}})]})})]}),e.jsx("div",{className:"formbutton",children:e.jsx("button",{className:"tranhatky",onClick:()=>{I()?N():f.fire("Thông báo","Hãy nhập đủ thông tin trước khi đăng ký","error")},children:"NHẬP KẾT QUẢ"})}),e.jsx("div",{className:"formbutton",style:{marginTop:"20px",display:"flex",flexWrap:"wrap"}})]}),e.jsx("div",{className:"tracuuYCSXTable",children:O})]})})})},Ft=()=>{const[n,d]=s.useState({tab1:!0,tab2:!1,tab3:!1,tab4:!1}),C=x=>{x===1?d({...n,tab1:!0,tab2:!1,tab3:!1,tab4:!1,tab5:!1}):x===2?d({...n,tab1:!1,tab2:!0,tab3:!1,tab4:!1,tab5:!1}):x===3?d({...n,tab1:!1,tab2:!1,tab3:!0,tab4:!1,tab5:!1}):x===4?d({...n,tab1:!1,tab2:!1,tab3:!1,tab4:!0,tab5:!1}):x===5&&d({...n,tab1:!1,tab2:!1,tab3:!1,tab4:!1,tab5:!0})};return s.useEffect(()=>{},[]),e.jsxs("div",{className:"dtc",children:[e.jsxs("div",{className:"mininavbar",children:[e.jsx("div",{className:"mininavitem",onClick:()=>C(1),style:{backgroundColor:n.tab1===!0?"#02c712":"#abc9ae",color:(n.tab1===!0,"yellow")},children:e.jsx("span",{className:"mininavtext",children:"TRA KQ ĐTC"})}),e.jsx("div",{className:"mininavitem",onClick:()=>C(2),style:{backgroundColor:n.tab2===!0?"#02c712":"#abc9ae",color:(n.tab2===!0,"yellow")},children:e.jsx("span",{className:"mininavtext",children:"TRA SPEC ĐTC"})}),e.jsx("div",{className:"mininavitem",onClick:()=>C(3),style:{backgroundColor:n.tab3===!0?"#02c712":"#abc9ae",color:(n.tab3===!0,"yellow")},children:e.jsx("span",{className:"mininavtext",children:"ADD SPEC ĐTC"})}),e.jsx("div",{className:"mininavitem",onClick:()=>C(4),style:{backgroundColor:n.tab4===!0?"#02c712":"#abc9ae",color:(n.tab4===!0,"yellow")},children:e.jsx("span",{className:"mininavtext",children:"ĐKÝ TEST ĐTC"})}),e.jsx("div",{className:"mininavitem",onClick:()=>C(5),style:{backgroundColor:n.tab5===!0?"#02c712":"#abc9ae",color:(n.tab5===!0,"yellow")},children:e.jsx("span",{className:"mininavtext",children:"NHẬP KQ ĐTC"})})]}),n.tab1&&e.jsx("div",{className:"trainspection",children:e.jsx(Rt,{})}),n.tab2&&e.jsx("div",{className:"trainspection",children:e.jsx(At,{})}),n.tab3&&e.jsx("div",{className:"trainspection",children:e.jsx(Mt,{})}),n.tab4&&e.jsx("div",{className:"trainspection",children:e.jsx(bt,{})}),n.tab5&&e.jsx("div",{className:"trainspection",children:e.jsx(vt,{})})]})};export{Ft as default};

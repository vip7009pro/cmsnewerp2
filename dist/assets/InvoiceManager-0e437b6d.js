import{r,k as st,ai as m,a_ as ct,j as t,aT as v,aj as le,I as x,aV as ht,a$ as dt,b0 as ut,ak as re,al as mt,br as _t,aW as Et,aZ as gt,aX as ft,aY as Nt,ad as _,S as c}from"./index-4ab6dde0.js";import{b as Tt}from"./index.esm-f9b137af.js";import{D as se,A as ce,G as he,b as de,c as xt}from"./DataGrid-b5e0acb2.js";import{T as D}from"./TextField-db9fe3d0.js";import{G as ue,a as me,b as _e}from"./GridToolbarFilterButton-ec6062d3.js";import"./MenuItem-8199bc03.js";import"./Typography-b6d023f3.js";const Mt=()=>{const[pt,Ee]=r.useTransition(),[g,p]=r.useState({trapo:!0,thempohangloat:!1,them1po:!1,them1invoice:!1,testinvoicetable:!1}),o=st(e=>e.totalSlice.userData),[d,O]=r.useState([]),[Y,C]=r.useState(!1),[St,ge]=r.useState([]),[G,fe]=r.useState(m().format("YYYY-MM-DD")),[k,Ne]=r.useState(m().format("YYYY-MM-DD")),[U,Te]=r.useState(""),[F,xe]=r.useState(""),[K,pe]=r.useState(""),[V,Se]=r.useState(""),[H,Ce]=r.useState(""),[B,De]=r.useState(""),[y,we]=r.useState(!0),[be,Ct]=r.useState(!0),[s,Q]=r.useState(),[h,z]=r.useState(),[Dt,ve]=r.useState(m().format("YYYY-MM-DD")),[wt,Oe]=r.useState(m().format("YYYY-MM-DD")),[f,I]=r.useState("");r.useState("");const[bt,ye]=r.useState("");r.useState("");const[N,j]=r.useState(0),[S,P]=r.useState(m().format("YYYY-MM-DD")),[A,L]=r.useState(""),[W,Ie]=r.useState({total_po_qty:0,total_delivered_qty:0,total_pobalance_qty:0,total_po_amount:0,total_delivered_amount:0,total_pobalance_amount:0}),[je,Pe]=r.useState([]),[Ae,Le]=r.useState([]),[q,Me]=r.useState(""),[J,Re]=r.useState(""),[X,Ye]=r.useState(""),[Ge,ke]=r.useState(""),[w,Ue]=r.useState([]),[u,$]=r.useState([]),[Fe,Ke]=r.useState(),[Z,ee]=r.useState(!1),Ve=[{field:"CUST_NAME_KD",headerName:"CUST_NAME_KD",width:110},{field:"EMPL_NAME",headerName:"EMPL_NAME",width:130},{field:"G_CODE",headerName:"G_CODE",width:80},{field:"G_NAME",headerName:"G_NAME",flex:1,minWidth:180,renderCell:e=>t.jsx("span",{style:{color:"red"},children:t.jsx("b",{children:e.row.G_NAME})})},{field:"G_NAME_KD",headerName:"G_NAME_KD",width:120},{field:"PO_NO",headerName:"PO_NO",width:100},{field:"DELIVERY_DATE",type:"date",headerName:"DELIVERY_DATE",width:120},{field:"DELIVERY_QTY",type:"number",headerName:"DELIVERY_QTY",width:100,renderCell:e=>t.jsx("span",{style:{color:"blue"},children:t.jsx("b",{children:e.row.DELIVERY_QTY.toLocaleString("en-US")})})},{field:"PROD_PRICE",type:"number",headerName:"PROD_PRICE",width:100,renderCell:e=>t.jsx("span",{style:{color:"gray"},children:t.jsx("b",{children:e.row.PROD_PRICE.toLocaleString("en-US",{style:"decimal",maximumFractionDigits:8})})})},{field:"DELIVERED_AMOUNT",type:"number",headerName:"DELIVERED_AMOUNT",width:120,renderCell:e=>t.jsx("span",{style:{color:"green"},children:t.jsx("b",{children:e.row.DELIVERED_AMOUNT.toLocaleString("en-US",{style:"currency",currency:"USD"})})})},{field:"PROD_TYPE",headerName:"PROD_TYPE",width:90},{field:"PROD_MODEL",headerName:"PROD_MODEL",width:120},{field:"PROD_PROJECT",headerName:"PROD_PROJECT",width:120},{field:"PROD_MAIN_MATERIAL",headerName:"PROD_MAIN_MATERIAL",width:120},{field:"YEARNUM",type:"number",headerName:"YEARNUM",width:80},{field:"WEEKNUM",type:"number",headerName:"WEEKNUM",width:80},{field:"INVOICE_NO",type:"number",headerName:"INVOICE_NO",width:120},{field:"DELIVERY_ID",headerName:"DELIVERY_ID",width:90},{field:"REMARK",headerName:"REMARK",width:120}],He=[{field:"CUST_CD",headerName:"CUST_CD",width:120},{field:"G_CODE",headerName:"G_CODE",width:120},{field:"PO_NO",headerName:"PO_NO",width:120},{field:"DELIVERY_QTY",type:"number",headerName:"DELIVERY_QTY",width:120,renderCell:e=>t.jsx("span",{style:{color:"blue"},children:t.jsx("b",{children:e.row.DELIVERY_QTY})})},{field:"DELIVERY_DATE",type:"date",headerName:"DELIVERY_DATE",width:200},{field:"INVOICE_NO",type:"string",headerName:"INVOICE_NO",width:200},{field:"CHECKSTATUS",headerName:"CHECKSTATUS",width:200,renderCell:e=>e.row.CHECKSTATUS.slice(0,2)==="OK"?t.jsx("span",{style:{color:"green"},children:t.jsx("b",{children:e.row.CHECKSTATUS})}):t.jsx("span",{style:{color:"red"},children:t.jsx("b",{children:e.row.CHECKSTATUS})})}],E=e=>{e.key==="Enter"&&te()};function Be(){return t.jsxs(he,{children:[t.jsx(ue,{}),t.jsx(me,{}),t.jsx(_e,{}),t.jsx("button",{className:"saveexcelbutton",onClick:()=>{re(d,"Uploaded PO")},children:"Save Excel"}),t.jsx(de,{})]})}function Qe(){return t.jsxs(he,{children:[t.jsx(ue,{}),t.jsx(me,{}),t.jsx(_e,{}),t.jsxs(x,{className:"buttonIcon",onClick:()=>{re(w,"Invoice Table")},children:[t.jsx(mt,{color:"green",size:25}),"SAVE"]}),t.jsxs(x,{className:"buttonIcon",onClick:()=>{v(o==null?void 0:o.EMPL_NO,o==null?void 0:o.MAINDEPTNAME,["KD"],()=>{p({...g,trapo:!0,thempohangloat:!1,them1po:!1,them1invoice:!0}),M()})},children:[t.jsx(_t,{color:"blue",size:25}),"NEW INV"]}),t.jsxs(x,{className:"buttonIcon",onClick:()=>{v(o==null?void 0:o.EMPL_NO,o==null?void 0:o.MAINDEPTNAME,["KD"],at)},children:[t.jsx(Tt,{color:"lightgreen",size:25}),"SỬA INV"]}),t.jsxs(x,{className:"buttonIcon",onClick:()=>{v(o==null?void 0:o.EMPL_NO,o==null?void 0:o.MAINDEPTNAME,["KD"],ot)},children:[t.jsx(Et,{color:"red",size:25}),"XÓA INV"]}),t.jsx(de,{}),t.jsxs(x,{className:"buttonIcon",onClick:()=>{ee(!Z)},children:[t.jsx(gt,{color:"#ff33bb",size:25}),"Pivot"]})]})}const ze=e=>{if(e.preventDefault(),e.target.files){const a=new FileReader;a.onload=i=>{const n=i.target.result,T=ft(n,{type:"array"}),l=T.SheetNames[0],R=T.Sheets[l],ie=Nt.sheet_to_json(R);let ne=Object.keys(ie[0]).map((b,oe)=>({field:b,headerName:b,width:150}));ne.push({field:"CHECKSTATUS",headerName:"CHECKSTATUS",width:350}),ge(ne),O(ie.map((b,oe)=>({...b,id:oe,CHECKSTATUS:"Waiting"})))},a.readAsArrayBuffer(e.target.files[0])}},te=()=>{C(!0),_("traInvoiceDataFull",{alltime:y,justPoBalance:be,start_date:G,end_date:k,cust_name:V,codeCMS:F,codeKD:U,prod_type:H,empl_name:K,po_no:q,over:X,id:B,material:J}).then(e=>{if(e.data.tk_status!=="NG"){const a=e.data.data.map((n,T)=>({...n,DELIVERY_DATE:n.DELIVERY_DATE.slice(0,10)}));let i={total_po_qty:0,total_delivered_qty:0,total_pobalance_qty:0,total_po_amount:0,total_delivered_amount:0,total_pobalance_amount:0};for(let n=0;n<a.length;n++)i.total_delivered_qty+=a[n].DELIVERY_QTY,i.total_delivered_amount+=a[n].DELIVERED_AMOUNT;Ie(i),Ue(a),C(!1),c.fire("Thông báo","Đã load "+e.data.data.length+" dòng","success")}else c.fire("Thông báo","Nội dung: "+e.data.message,"error"),C(!1)}).catch(e=>{console.log(e)})},We=async()=>{C(!0);let e=d;for(let a=0;a<d.length;a++){let i=0;await _("checkPOExist",{G_CODE:d[a].G_CODE,CUST_CD:d[a].CUST_CD,PO_NO:d[a].PO_NO}).then(l=>{l.data.tk_status!=="NG"?d[a].DELIVERY_QTY>l.data.data[0].PO_BALANCE&&(i=5):i=1}).catch(l=>{console.log(l)});let n=m(),T=m(d[a].DELIVERY_DATE);n<T&&(i=2),await _("checkGCodeVer",{G_CODE:d[a].G_CODE}).then(l=>{l.data.tk_status!=="NG"?l.data.data[0].USE_YN==="Y"||(i=3):i=4}).catch(l=>{console.log(l)}),await _("checkcustcodeponoPOBALANCE",{G_CODE:s==null?void 0:s.G_CODE,CUST_CD:h==null?void 0:h.CUST_CD,PO_NO:f}).then(l=>{console.log(l.data.tk_status),l.data.tk_status!=="NG"&&l.data.data[0].PO_BALANCE<N&&(i=5)}).catch(l=>{console.log(l)}),i===0?e[a].CHECKSTATUS="OK":i===1?e[a].CHECKSTATUS="NG: Không tồn tại PO":i===2?e[a].CHECKSTATUS="NG: Ngày Giao hàng không được trước ngày hôm nay":i===3?e[a].CHECKSTATUS="NG: Ver này đã bị khóa":i===4?e[a].CHECKSTATUS="NG: Không có code CMS này":i===5&&(e[a].CHECKSTATUS="NG: Giao hàng nhiều hơn PO")}C(!1),c.fire("Thông báo","Đã hoàn thành check Invoice hàng loạt","success"),O(e)},qe=async()=>{let e=d;for(let a=0;a<d.length;a++){let i=0;await _("checkPOExist",{G_CODE:d[a].G_CODE,CUST_CD:d[a].CUST_CD,PO_NO:d[a].PO_NO}).then(l=>{console.log(l.data.tk_status),l.data.tk_status!=="NG"?d[a].DELIVERY_QTY>l.data.data[0].PO_BALANCE&&(i=5):i=1}).catch(l=>{console.log(l)});let n=m(),T=m(d[a].DELIVERY_DATE);n<T&&(i=2),await _("checkGCodeVer",{G_CODE:d[a].G_CODE}).then(l=>{console.log(l.data.tk_status),l.data.tk_status!=="NG"?(console.log(l.data.data),l.data.data[0].USE_YN==="Y"||(i=3)):i=4}).catch(l=>{console.log(l)}),await _("checkcustcodeponoPOBALANCE",{G_CODE:s==null?void 0:s.G_CODE,CUST_CD:h==null?void 0:h.CUST_CD,PO_NO:f}).then(l=>{console.log(l.data.tk_status),l.data.tk_status!=="NG"&&l.data.data[0].PO_BALANCE<N&&(i=5)}).catch(l=>{console.log(l)}),i===0?await _("insert_invoice",{DELIVERY_QTY:d[a].DELIVERY_QTY,DELIVERY_DATE:d[a].DELIVERY_DATE,REMARK:"",G_CODE:d[a].G_CODE,CUST_CD:d[a].CUST_CD,PO_NO:d[a].PO_NO,EMPL_NO:o==null?void 0:o.EMPL_NO,INVOICE_NO:d[a].INVOICE_NO}).then(l=>{console.log(l.data.tk_status),l.data.tk_status!=="NG"?e[a].CHECKSTATUS="OK":(i=5,e[a].CHECKSTATUS="NG: Lỗi SQL: "+l.data.message)}).catch(l=>{console.log(l)}):i===1?e[a].CHECKSTATUS="NG: Không tồn tại PO":i===2?e[a].CHECKSTATUS="NG: Ngày Giao hàng không được trước ngày hôm nay":i===3?e[a].CHECKSTATUS="NG: Ver này đã bị khóa":i===4?e[a].CHECKSTATUS="NG: Không có code CMS này":i===5&&(e[a].CHECKSTATUS="NG: Giao hàng nhiều hơn PO")}c.fire("Thông báo","Đã hoàn thành thêm Invoice hàng loạt","success"),O(e)},Je=()=>{c.fire({title:"Chắc chắn muốn thêm Invoice hàng loạt ?",text:"Thêm rồi mà sai, sửa là hơi vất đấy",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Vẫn thêm!"}).then(e=>{e.isConfirmed&&(c.fire("Tiến hành thêm","Đang thêm Invoice hàng loạt","success"),qe())})},Xe=()=>{c.fire({title:"Chắc chắn muốn check Invoice hàng loạt ?",text:"Sẽ bắt đầu check Invoice hàng loạt",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Vẫn check!"}).then(e=>{e.isConfirmed&&(c.fire("Tiến hành check","Đang check Invoice hàng loạt","success"),We())})},$e=()=>{_("selectcustomerList",{}).then(e=>{e.data.tk_status!=="NG"&&Pe(e.data.data)}).catch(e=>{console.log(e)})},Ze=e=>{Ee(()=>{_("selectcodeList",{G_NAME:e}).then(a=>{a.data.tk_status!=="NG"&&Le(a.data.data)}).catch(a=>{console.log(a)})})},ae=e=>{e===1?p({...g,trapo:!0,thempohangloat:!1,them1po:!1,them1invoice:!1,testinvoicetable:!1}):e===2?p({...g,trapo:!1,thempohangloat:!0,them1po:!1,them1invoice:!1,testinvoicetable:!1}):e===3&&p({...g,trapo:!1,thempohangloat:!1,them1po:!1,them1invoice:!1,testinvoicetable:!0})},et=async()=>{let e=0;await _("checkPOExist",{G_CODE:s==null?void 0:s.G_CODE,CUST_CD:h==null?void 0:h.CUST_CD,PO_NO:f}).then(n=>{console.log(n.data.tk_status),n.data.tk_status!=="NG"?N>n.data.data.PO_BALANCE&&(e=5):e=1}).catch(n=>{console.log(n)});let a=m(),i=m(S);a<i&&(e=2),(s==null?void 0:s.USE_YN)==="N"&&(e=3),((s==null?void 0:s.G_CODE)===""||(h==null?void 0:h.CUST_CD)===""||S===""||(o==null?void 0:o.EMPL_NO)===""||N===0)&&(e=4),await _("checkcustcodeponoPOBALANCE",{G_CODE:s==null?void 0:s.G_CODE,CUST_CD:h==null?void 0:h.CUST_CD,PO_NO:f}).then(n=>{console.log(n.data.tk_status),n.data.tk_status!=="NG"&&n.data.data[0].PO_BALANCE<N&&(e=5)}).catch(n=>{console.log(n)}),e===0?await _("insert_invoice",{G_CODE:s==null?void 0:s.G_CODE,CUST_CD:h==null?void 0:h.CUST_CD,PO_NO:f,EMPL_NO:o==null?void 0:o.EMPL_NO,DELIVERY_QTY:N,DELIVERY_DATE:S,REMARK:A,INVOICE_NO:""}).then(n=>{console.log(n.data.tk_status),n.data.tk_status!=="NG"?c.fire("Thông báo","Thêm Invoice mới thành công","success"):c.fire("Thông báo","Thêm Invoice mới thất bại: "+n.data.message,"error")}).catch(n=>{console.log(n)}):e===1?c.fire("Thông báo","NG: Không tồn tại PO","error"):e===2?c.fire("Thông báo","NG: Ngày Invoice không được trước ngày hôm nay","error"):e===3?c.fire("Thông báo","NG: Ver này đã bị khóa","error"):e===4?c.fire("Thông báo","NG: Không để trống thông tin bắt buộc","error"):e===5&&c.fire("Thông báo","NG: Số lượng giao hàng nhiều hơn PO BALANCE","error")},M=()=>{ve(m().format("YYYY-MM-DD")),Oe(m().format("YYYY-MM-DD")),I(""),j(0),P(m().format("YYYY-MM-DD")),L("")},tt=e=>{const a=new Set(e);let i=w.filter(n=>a.has(n.DELIVERY_ID));i.length>0?$(i):$([])},at=()=>{if(u.length===1){p({...g,trapo:!0,thempohangloat:!1,them1po:!1,them1invoice:!0});const e={G_CODE:u[u.length-1].G_CODE,G_NAME:u[u.length-1].G_NAME,PROD_LAST_PRICE:Number(u[u.length-1].PROD_PRICE),USE_YN:"Y"},a={CUST_CD:u[u.length-1].CUST_CD,CUST_NAME_KD:u[u.length-1].CUST_NAME_KD};Q(e),z(a),j(u[u.length-1].DELIVERY_QTY),I(u[u.length-1].PO_NO),P(m().format("YYYY-MM-DD")),L(u[u.length-1].REMARK),Ke(u[u.length-1].DELIVERY_ID)}else u.length===0?(M(),c.fire("Thông báo","Lỗi: Chọn ít nhất 1 Invoice để sửa","error")):c.fire("Thông báo","Lỗi: Chỉ tích chọn 1 dòng thêm thôi","error")},it=async()=>{let e=0;await _("checkPOExist",{G_CODE:s==null?void 0:s.G_CODE,CUST_CD:h==null?void 0:h.CUST_CD,PO_NO:f}).then(n=>{console.log(n.data.tk_status),n.data.tk_status!=="NG"||(e=1)}).catch(n=>{console.log(n)});let a=m(),i=m(S);a<i&&(e=2),(s==null?void 0:s.USE_YN)==="N"&&(e=3),((s==null?void 0:s.G_CODE)===""||(h==null?void 0:h.CUST_CD)===""||f===""||(o==null?void 0:o.EMPL_NO)==="")&&(e=4),e===0?await _("update_invoice",{G_CODE:s==null?void 0:s.G_CODE,CUST_CD:h==null?void 0:h.CUST_CD,PO_NO:f,EMPL_NO:o==null?void 0:o.EMPL_NO,DELIVERY_DATE:S,DELIVERY_QTY:N,REMARK:A,DELIVERY_ID:Fe}).then(n=>{console.log(n.data.tk_status),n.data.tk_status!=="NG"?c.fire("Thông báo","Update Invoice thành công","success"):c.fire("Thông báo","Update Invoice thất bại: "+n.data.message,"error")}).catch(n=>{console.log(n)}):e===1?c.fire("Thông báo","NG: Không tồn tại PO","error"):e===2?c.fire("Thông báo","NG: Ngày Giao Hàng không được trước ngày hôm nay","error"):e===3?c.fire("Thông báo","NG: Ver này đã bị khóa","error"):e===4?c.fire("Thông báo","NG: Không để trống thông tin bắt buộc","error"):c.fire("Thông báo","Lỗi","error")},nt=async()=>{if(u.length>=1){let e=!1;for(let a=0;a<u.length;a++)u[a].EMPL_NO===(o==null?void 0:o.EMPL_NO)&&await _("delete_invoice",{DELIVERY_ID:u[a].DELIVERY_ID}).then(i=>{console.log(i.data.tk_status),i.data.tk_status!=="NG"||(e=!0)}).catch(i=>{console.log(i)});e?c.fire("Thông báo","Có lỗi SQL!","error"):c.fire("Thông báo","Xóa Invoice thành công (chỉ Invoice của người đăng nhập)!","success")}else c.fire("Thông báo","Chọn ít nhất 1 Invoice để xóa !","error")},ot=()=>{c.fire({title:"Chắc chắn muốn xóa Invoice đã chọn ?",text:"Sẽ chỉ xóa invoice do bạn up lên",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Vẫn Xóa!"}).then(e=>{e.isConfirmed&&(c.fire("Tiến hành Xóa","Đang Xóa Invoice hàng loạt","success"),nt())})},lt=xt({matchFrom:"any",limit:100}),rt=new ct({fields:[{caption:"PROD_MAIN_MATERIAL",width:80,dataField:"PROD_MAIN_MATERIAL",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"DELIVERY_ID",width:80,dataField:"DELIVERY_ID",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"CUST_CD",width:80,dataField:"CUST_CD",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"CUST_NAME_KD",width:80,dataField:"CUST_NAME_KD",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"EMPL_NO",width:80,dataField:"EMPL_NO",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"EMPL_NAME",width:80,dataField:"EMPL_NAME",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"G_CODE",width:80,dataField:"G_CODE",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"G_NAME",width:80,dataField:"G_NAME",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"G_NAME_KD",width:80,dataField:"G_NAME_KD",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"PO_NO",width:80,dataField:"PO_NO",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"DELIVERY_DATE",width:80,dataField:"DELIVERY_DATE",allowSorting:!0,allowFiltering:!0,dataType:"date",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"DELIVERY_QTY",width:80,dataField:"DELIVERY_QTY",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"PROD_PRICE",width:80,dataField:"PROD_PRICE",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"currency",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"DELIVERED_AMOUNT",width:80,dataField:"DELIVERED_AMOUNT",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"currency",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"REMARK",width:80,dataField:"REMARK",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"INVOICE_NO",width:80,dataField:"INVOICE_NO",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"PROD_TYPE",width:80,dataField:"PROD_TYPE",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"PROD_MODEL",width:80,dataField:"PROD_MODEL",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"PROD_PROJECT",width:80,dataField:"PROD_PROJECT",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"YEARNUM",width:80,dataField:"YEARNUM",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"WEEKNUM",width:80,dataField:"WEEKNUM",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}}],store:w});return r.useEffect(()=>{$e(),Ze("")},[]),t.jsxs("div",{className:"invoicemanager",children:[t.jsxs("div",{className:"mininavbar",children:[t.jsx("div",{className:"mininavitem",onClick:()=>ae(1),style:{backgroundColor:g.trapo===!0?"#02c712":"#abc9ae",color:(g.trapo===!0,"yellow")},children:t.jsx("span",{className:"mininavtext",children:"Tra Invoice"})}),t.jsx("div",{className:"mininavitem",onClick:()=>v(o==null?void 0:o.EMPL_NO,o==null?void 0:o.MAINDEPTNAME,["KD"],()=>{ae(2)}),style:{backgroundColor:g.thempohangloat===!0?"#02c712":"#abc9ae",color:(g.thempohangloat===!0,"yellow")},children:t.jsx("span",{className:"mininavtext",children:"Thêm Invoice"})})]}),g.thempohangloat&&t.jsx("div",{className:"newinvoice",children:t.jsxs("div",{className:"batchnewinvoice",children:[t.jsx("h3",{children:"Thêm Invoice Hàng Loạt"}),t.jsxs("form",{className:"formupload",children:[t.jsxs("label",{htmlFor:"upload",children:[t.jsx("b",{children:"Chọn file Excel: "}),t.jsx("input",{onKeyDown:e=>{E(e)},className:"selectfilebutton",type:"file",name:"upload",id:"upload",onChange:e=>{ze(e)}})]}),t.jsx("div",{className:"checkpobutton",onClick:e=>{e.preventDefault(),Xe()},children:"Check Invoice"}),t.jsx("div",{className:"uppobutton",onClick:e=>{e.preventDefault(),Je()},children:"Up Invoice"})]}),t.jsx("div",{className:"insertInvoiceTable",children:t.jsx(se,{sx:{fontSize:"0.7rem",flex:1},components:{Toolbar:Be,LoadingOverlay:le},loading:Y,rowHeight:35,rows:d,columns:He,rowsPerPageOptions:[5,10,50,100,500,1e3,5e3,1e4,1e5],editMode:"row"})})]})}),g.trapo&&t.jsxs("div",{className:"tracuuInvoice",children:[t.jsxs("div",{className:"tracuuInvoiceform",children:[t.jsxs("div",{className:"forminput",children:[t.jsxs("div",{className:"forminputcolumn",children:[t.jsxs("label",{children:[t.jsx("b",{children:"Từ ngày:"}),t.jsx("input",{onKeyDown:e=>{E(e)},type:"date",value:G.slice(0,10),onChange:e=>fe(e.target.value)})]}),t.jsxs("label",{children:[t.jsx("b",{children:"Tới ngày:"})," ",t.jsx("input",{onKeyDown:e=>{E(e)},type:"date",value:k.slice(0,10),onChange:e=>Ne(e.target.value)})]})]}),t.jsxs("div",{className:"forminputcolumn",children:[t.jsxs("label",{children:[t.jsx("b",{children:"Code KD:"})," ",t.jsx("input",{onKeyDown:e=>{E(e)},type:"text",placeholder:"GH63-xxxxxx",value:U,onChange:e=>Te(e.target.value)})]}),t.jsxs("label",{children:[t.jsx("b",{children:"Code CMS:"})," ",t.jsx("input",{onKeyDown:e=>{E(e)},type:"text",placeholder:"7C123xxx",value:F,onChange:e=>xe(e.target.value)})]})]}),t.jsxs("div",{className:"forminputcolumn",children:[t.jsxs("label",{children:[t.jsx("b",{children:"Tên nhân viên:"})," ",t.jsx("input",{onKeyDown:e=>{E(e)},type:"text",placeholder:"Trang",value:K,onChange:e=>pe(e.target.value)})]}),t.jsxs("label",{children:[t.jsx("b",{children:"Khách:"})," ",t.jsx("input",{onKeyDown:e=>{E(e)},type:"text",placeholder:"SEVT",value:V,onChange:e=>Se(e.target.value)})]})]}),t.jsxs("div",{className:"forminputcolumn",children:[t.jsxs("label",{children:[t.jsx("b",{children:"Loại sản phẩm:"})," ",t.jsx("input",{onKeyDown:e=>{E(e)},type:"text",placeholder:"TSP",value:H,onChange:e=>Ce(e.target.value)})]}),t.jsxs("label",{children:[t.jsx("b",{children:"ID:"})," ",t.jsx("input",{onKeyDown:e=>{E(e)},type:"text",placeholder:"12345",value:B,onChange:e=>De(e.target.value)})]})]}),t.jsxs("div",{className:"forminputcolumn",children:[t.jsxs("label",{children:[t.jsx("b",{children:"PO NO:"})," ",t.jsx("input",{onKeyDown:e=>{E(e)},type:"text",placeholder:"123abc",value:q,onChange:e=>Me(e.target.value)})]}),t.jsxs("label",{children:[t.jsx("b",{children:"Vật liệu:"})," ",t.jsx("input",{onKeyDown:e=>{E(e)},type:"text",placeholder:"SJ-203020HC",value:J,onChange:e=>Re(e.target.value)})]})]}),t.jsxs("div",{className:"forminputcolumn",children:[t.jsxs("label",{children:[t.jsx("b",{children:"Over/OK:"})," ",t.jsx("input",{onKeyDown:e=>{E(e)},type:"text",placeholder:"OVER",value:X,onChange:e=>Ye(e.target.value)})]}),t.jsxs("label",{children:[t.jsx("b",{children:"Invoice No:"})," ",t.jsx("input",{onKeyDown:e=>{E(e)},type:"text",placeholder:"số invoice",value:Ge,onChange:e=>ke(e.target.value)})]})]})]}),t.jsxs("div",{className:"formbutton",children:[t.jsxs("label",{children:[t.jsx("b",{children:"All Time:"}),t.jsx("input",{onKeyDown:e=>{E(e)},type:"checkbox",name:"alltimecheckbox",defaultChecked:y,onChange:()=>we(!y)})]}),t.jsxs(x,{className:"buttonIcon",onClick:()=>{te()},children:[t.jsx(ht,{color:"green",size:30}),"Search"]})]}),t.jsx("div",{className:"formsummary",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("td",{children:"DELIVERED QTY"}),t.jsx("td",{children:"DELIVERED AMOUNT"})]})}),t.jsx("tbody",{children:t.jsxs("tr",{children:[t.jsxs("td",{style:{color:"purple",fontWeight:"bold"},children:[" ",W.total_delivered_qty.toLocaleString("en-US")," ","EA"]}),t.jsxs("td",{style:{color:"purple",fontWeight:"bold"},children:[" ",W.total_delivered_amount.toLocaleString("en-US",{style:"currency",currency:"USD"})," "]})]})})]})})]}),t.jsx("div",{className:"tracuuInvoiceTable",children:t.jsx(se,{sx:{fontSize:"0.7rem"},components:{Toolbar:Qe,LoadingOverlay:le},loading:Y,rowHeight:30,rows:w,columns:Ve,rowsPerPageOptions:[5,10,50,100,500,1e3,5e3,1e4,1e5],editMode:"row",getRowId:e=>e.DELIVERY_ID,checkboxSelection:!0,disableSelectionOnClick:!0,onSelectionModelChange:e=>{tt(e)}})})]}),g.them1invoice&&t.jsx("div",{className:"them1invoice",children:t.jsx("div",{className:"formnho",children:t.jsxs("div",{className:"dangkyform",children:[t.jsx("h3",{children:"Thêm Invoice mới"}),t.jsxs("div",{className:"dangkyinput",children:[t.jsxs("div",{className:"dangkyinputbox",children:[t.jsxs("label",{children:[t.jsx("b",{children:"Khách hàng:"})," ",t.jsx(ce,{size:"small",disablePortal:!0,options:je,className:"autocomplete",getOptionLabel:e=>`${e.CUST_CD}: ${e.CUST_NAME_KD}`,renderInput:e=>t.jsx(D,{...e,label:"Select customer"}),value:h,onChange:(e,a)=>{console.log(a),z(a)}})]}),t.jsxs("label",{children:[t.jsx("b",{children:"Code hàng:"})," ",t.jsx(ce,{size:"small",disablePortal:!0,options:Ae,className:"autocomplete",filterOptions:lt,getOptionLabel:e=>`${e.G_CODE}: ${e.G_NAME}`,renderInput:e=>t.jsx(D,{...e,label:"Select code"}),onChange:(e,a)=>{console.log(a),ye(a===null?"":a.PROD_LAST_PRICE.toString()),Q(a)},value:s})]}),t.jsxs("label",{children:[t.jsx("b",{children:"PO NO:"})," ",t.jsx(D,{value:f,onChange:e=>I(e.target.value),size:"small",color:"success",className:"autocomplete",id:"outlined-basic",label:"Số PO",variant:"outlined"})]})]}),t.jsxs("div",{className:"dangkyinputbox",children:[t.jsxs("label",{children:[t.jsx("b",{children:"Invoice QTY:"})," ",t.jsx(D,{value:N,onChange:e=>j(Number(e.target.value)),size:"small",color:"success",className:"autocomplete",id:"outlined-basic",label:"INVOICE QTY",variant:"outlined"})]}),t.jsxs("label",{children:[t.jsx("b",{children:"Invoice Date:"})," ",t.jsx("input",{onKeyDown:e=>{E(e)},className:"inputdata",type:"date",value:S.slice(0,10),onChange:e=>P(e.target.value)})]}),t.jsxs("label",{children:[t.jsx("b",{children:"Remark:"})," ",t.jsx(D,{value:A,onChange:e=>L(e.target.value),size:"small",className:"autocomplete",id:"outlined-basic",label:"Remark",variant:"outlined"})]})]})]}),t.jsxs("div",{className:"dangkybutton",children:[t.jsx("button",{className:"thembutton",onClick:()=>{et()},children:"Thêm Invoice"}),t.jsx("button",{className:"closebutton",onClick:()=>{it()},children:"Sửa Invoice"}),t.jsx("button",{className:"suabutton",onClick:()=>{M()},children:"Clear"}),t.jsx("button",{className:"closebutton",onClick:()=>{p({...g,trapo:!0,thempohangloat:!1,them1po:!1,them1invoice:!1})},children:"Close"})]})]})})}),Z&&t.jsxs("div",{className:"pivottable1",children:[t.jsxs(x,{className:"buttonIcon",onClick:()=>{ee(!1)},children:[t.jsx(dt,{color:"blue",size:25}),"Close"]}),t.jsx(ut,{datasource:rt,tableID:"invoicetablepivot"})]})]})};export{Mt as default};

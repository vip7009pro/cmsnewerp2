import{r as o,k as Ee,ai as I,a_ as ve,j as r,aT as b,aj as H,I as w,aV as Ue,a$ as _e,b0 as De,ak as Y,al as Pe,aW as Le,aZ as Oe,aX as Ke,aY as Me,ad as W,S as s}from"./index-4ab6dde0.js";import{D as B,G as V,b as J}from"./DataGrid-b5e0acb2.js";import{G as z,a as X,b as Q}from"./GridToolbarFilterButton-ec6062d3.js";import"./TextField-db9fe3d0.js";import"./MenuItem-8199bc03.js";import"./Typography-b6d023f3.js";const ze=()=>{const[h,S]=o.useState({trapo:!0,thempohangloat:!1,them1po:!1,them1invoice:!1,testinvoicetable:!1}),d=Ee(e=>e.totalSlice.userData),[l,p]=o.useState([]),[x,u]=o.useState(!1),[ke,$]=o.useState([]),[f,Z]=o.useState(I().format("YYYY-MM-DD")),[C,q]=o.useState(I().format("YYYY-MM-DD")),[A,ee]=o.useState(""),[T,re]=o.useState(""),[F,te]=o.useState(""),[j,ae]=o.useState(""),[N,le]=o.useState(""),[E,ie]=o.useState(""),[g,ne]=o.useState(!0),[oe,Ge]=o.useState(!0),[v,de]=o.useState(""),[U,ce]=o.useState(""),[_,se]=o.useState(""),[he,ue]=o.useState(""),[y,We]=o.useState([]),[m,D]=o.useState([]),[P,L]=o.useState(!1),we=[{field:"FCST_ID",headerName:"FCST_ID",width:80},{field:"FCSTYEAR",headerName:"FCSTYEAR",width:80},{field:"FCSTWEEKNO",headerName:"FCSTWEEKNO",width:80},{field:"G_CODE",headerName:"G_CODE",width:80},{field:"G_NAME_KD",headerName:"G_NAME_KD",width:120},{field:"G_NAME",headerName:"G_NAME",width:250,renderCell:e=>r.jsx("span",{style:{color:"red"},children:r.jsx("b",{children:e.row.G_NAME})})},{field:"EMPL_NAME",headerName:"EMPL_NAME",width:150},{field:"CUST_NAME_KD",headerName:"CUST_NAME_KD",width:80},{field:"PROD_PROJECT",headerName:"PROD_PROJECT",width:80},{field:"PROD_MODEL",headerName:"PROD_MODEL",width:80},{field:"PROD_MAIN_MATERIAL",headerName:"PROD_MAIN_MATERIAL",width:80},{field:"PROD_PRICE",type:"number",headerName:"PROD_PRICE",width:80},{field:"W1",type:"number",headerName:"W1",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W1.toLocaleString("en-US")})})},{field:"W2",type:"number",headerName:"W2",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W2.toLocaleString("en-US")})})},{field:"W3",type:"number",headerName:"W3",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W3.toLocaleString("en-US")})})},{field:"W4",type:"number",headerName:"W4",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W4.toLocaleString("en-US")})})},{field:"W5",type:"number",headerName:"W5",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W5.toLocaleString("en-US")})})},{field:"W6",type:"number",headerName:"W6",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W6.toLocaleString("en-US")})})},{field:"W7",type:"number",headerName:"W7",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W7.toLocaleString("en-US")})})},{field:"W8",type:"number",headerName:"W8",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W8.toLocaleString("en-US")})})},{field:"W9",type:"number",headerName:"W9",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W9.toLocaleString("en-US")})})},{field:"W10",type:"number",headerName:"W10",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W10.toLocaleString("en-US")})})},{field:"W11",type:"number",headerName:"W11",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W11.toLocaleString("en-US")})})},{field:"W12",type:"number",headerName:"W12",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W12.toLocaleString("en-US")})})},{field:"W13",type:"number",headerName:"W13",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W13.toLocaleString("en-US")})})},{field:"W14",type:"number",headerName:"W14",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W14.toLocaleString("en-US")})})},{field:"W15",type:"number",headerName:"W15",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W15.toLocaleString("en-US")})})},{field:"W16",type:"number",headerName:"W16",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W16.toLocaleString("en-US")})})},{field:"W17",type:"number",headerName:"W17",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W17.toLocaleString("en-US")})})},{field:"W18",type:"number",headerName:"W18",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W18.toLocaleString("en-US")})})},{field:"W19",type:"number",headerName:"W19",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W19.toLocaleString("en-US")})})},{field:"W20",type:"number",headerName:"W20",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W20.toLocaleString("en-US")})})},{field:"W21",type:"number",headerName:"W21",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W21.toLocaleString("en-US")})})},{field:"W22",type:"number",headerName:"W22",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W22.toLocaleString("en-US")})})},{field:"W1A",type:"number",headerName:"W1A",width:80,renderCell:e=>r.jsx("span",{style:{color:"green"},children:r.jsx("b",{children:e.row.W1A.toLocaleString("en-US",{style:"currency",currency:"USD"})})})},{field:"W2A",type:"number",headerName:"W2A",width:80,renderCell:e=>r.jsx("span",{style:{color:"green"},children:r.jsx("b",{children:e.row.W2A.toLocaleString("en-US",{style:"currency",currency:"USD"})})})},{field:"W3A",type:"number",headerName:"W3A",width:80,renderCell:e=>r.jsx("span",{style:{color:"green"},children:r.jsx("b",{children:e.row.W3A.toLocaleString("en-US",{style:"currency",currency:"USD"})})})},{field:"W4A",type:"number",headerName:"W4A",width:80,renderCell:e=>r.jsx("span",{style:{color:"green"},children:r.jsx("b",{children:e.row.W4A.toLocaleString("en-US",{style:"currency",currency:"USD"})})})},{field:"W5A",type:"number",headerName:"W5A",width:80,renderCell:e=>r.jsx("span",{style:{color:"green"},children:r.jsx("b",{children:e.row.W5A.toLocaleString("en-US",{style:"currency",currency:"USD"})})})},{field:"W6A",type:"number",headerName:"W6A",width:80,renderCell:e=>r.jsx("span",{style:{color:"green"},children:r.jsx("b",{children:e.row.W6A.toLocaleString("en-US",{style:"currency",currency:"USD"})})})},{field:"W7A",type:"number",headerName:"W7A",width:80,renderCell:e=>r.jsx("span",{style:{color:"green"},children:r.jsx("b",{children:e.row.W7A.toLocaleString("en-US",{style:"currency",currency:"USD"})})})},{field:"W8A",type:"number",headerName:"W8A",width:80,renderCell:e=>r.jsx("span",{style:{color:"green"},children:r.jsx("b",{children:e.row.W8A.toLocaleString("en-US",{style:"currency",currency:"USD"})})})},{field:"W9A",type:"number",headerName:"W9A",width:80,renderCell:e=>r.jsx("span",{style:{color:"green"},children:r.jsx("b",{children:e.row.W9A.toLocaleString("en-US",{style:"currency",currency:"USD"})})})},{field:"W10A",type:"number",headerName:"W10A",width:80,renderCell:e=>r.jsx("span",{style:{color:"green"},children:r.jsx("b",{children:e.row.W10A.toLocaleString("en-US",{style:"currency",currency:"USD"})})})},{field:"W11A",type:"number",headerName:"W11A",width:80,renderCell:e=>r.jsx("span",{style:{color:"green"},children:r.jsx("b",{children:e.row.W11A.toLocaleString("en-US",{style:"currency",currency:"USD"})})})},{field:"W12A",type:"number",headerName:"W12A",width:80,renderCell:e=>r.jsx("span",{style:{color:"green"},children:r.jsx("b",{children:e.row.W12A.toLocaleString("en-US",{style:"currency",currency:"USD"})})})},{field:"W13A",type:"number",headerName:"W13A",width:80,renderCell:e=>r.jsx("span",{style:{color:"green"},children:r.jsx("b",{children:e.row.W13A.toLocaleString("en-US",{style:"currency",currency:"USD"})})})},{field:"W14A",type:"number",headerName:"W14A",width:80,renderCell:e=>r.jsx("span",{style:{color:"green"},children:r.jsx("b",{children:e.row.W14A.toLocaleString("en-US",{style:"currency",currency:"USD"})})})},{field:"W15A",type:"number",headerName:"W15A",width:80,renderCell:e=>r.jsx("span",{style:{color:"green"},children:r.jsx("b",{children:e.row.W15A.toLocaleString("en-US",{style:"currency",currency:"USD"})})})},{field:"W16A",type:"number",headerName:"W16A",width:80,renderCell:e=>r.jsx("span",{style:{color:"green"},children:r.jsx("b",{children:e.row.W16A.toLocaleString("en-US",{style:"currency",currency:"USD"})})})},{field:"W17A",type:"number",headerName:"W17A",width:80,renderCell:e=>r.jsx("span",{style:{color:"green"},children:r.jsx("b",{children:e.row.W17A.toLocaleString("en-US",{style:"currency",currency:"USD"})})})},{field:"W18A",type:"number",headerName:"W18A",width:80,renderCell:e=>r.jsx("span",{style:{color:"green"},children:r.jsx("b",{children:e.row.W18A.toLocaleString("en-US",{style:"currency",currency:"USD"})})})},{field:"W19A",type:"number",headerName:"W19A",width:80,renderCell:e=>r.jsx("span",{style:{color:"green"},children:r.jsx("b",{children:e.row.W19A.toLocaleString("en-US",{style:"currency",currency:"USD"})})})},{field:"W20A",type:"number",headerName:"W20A",width:80,renderCell:e=>r.jsx("span",{style:{color:"green"},children:r.jsx("b",{children:e.row.W20A.toLocaleString("en-US",{style:"currency",currency:"USD"})})})},{field:"W21A",type:"number",headerName:"W21A",width:80,renderCell:e=>r.jsx("span",{style:{color:"green"},children:r.jsx("b",{children:e.row.W21A.toLocaleString("en-US",{style:"currency",currency:"USD"})})})},{field:"W22A",type:"number",headerName:"W22A",width:80,renderCell:e=>r.jsx("span",{style:{color:"green"},children:r.jsx("b",{children:e.row.W22A.toLocaleString("en-US",{style:"currency",currency:"USD"})})})}],ye=[{field:"EMPL_NO",headerName:"EMPL_NO",width:80},{field:"CUST_CD",headerName:"CUST_CD",width:80},{field:"G_CODE",headerName:"G_CODE",width:80},{field:"PROD_PRICE",headerName:"PROD_PRICE",width:80},{field:"YEAR",headerName:"YEAR",width:80},{field:"WEEKNO",headerName:"WEEKNO",width:80},{field:"W1",type:"number",headerName:"W1",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W1.toLocaleString("en-US")})})},{field:"W2",type:"number",headerName:"W2",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W2.toLocaleString("en-US")})})},{field:"W3",type:"number",headerName:"W3",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W3.toLocaleString("en-US")})})},{field:"W4",type:"number",headerName:"W4",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W4.toLocaleString("en-US")})})},{field:"W5",type:"number",headerName:"W5",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W5.toLocaleString("en-US")})})},{field:"W6",type:"number",headerName:"W6",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W6.toLocaleString("en-US")})})},{field:"W7",type:"number",headerName:"W7",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W7.toLocaleString("en-US")})})},{field:"W8",type:"number",headerName:"W8",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W8.toLocaleString("en-US")})})},{field:"W9",type:"number",headerName:"W9",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W9.toLocaleString("en-US")})})},{field:"W10",type:"number",headerName:"W10",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W10.toLocaleString("en-US")})})},{field:"W11",type:"number",headerName:"W11",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W11.toLocaleString("en-US")})})},{field:"W12",type:"number",headerName:"W12",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W12.toLocaleString("en-US")})})},{field:"W13",type:"number",headerName:"W13",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W13.toLocaleString("en-US")})})},{field:"W14",type:"number",headerName:"W14",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W14.toLocaleString("en-US")})})},{field:"W15",type:"number",headerName:"W15",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W15.toLocaleString("en-US")})})},{field:"W16",type:"number",headerName:"W16",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W16.toLocaleString("en-US")})})},{field:"W17",type:"number",headerName:"W17",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W17.toLocaleString("en-US")})})},{field:"W18",type:"number",headerName:"W18",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W18.toLocaleString("en-US")})})},{field:"W19",type:"number",headerName:"W19",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W19.toLocaleString("en-US")})})},{field:"W20",type:"number",headerName:"W20",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W20.toLocaleString("en-US")})})},{field:"W21",type:"number",headerName:"W21",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W21.toLocaleString("en-US")})})},{field:"W22",type:"number",headerName:"W22",width:80,renderCell:e=>r.jsx("span",{style:{color:"blue"},children:r.jsx("b",{children:e.row.W22.toLocaleString("en-US")})})},{field:"CHECKSTATUS",headerName:"CHECKSTATUS",width:200,renderCell:e=>e.row.CHECKSTATUS.slice(0,2)==="OK"?r.jsx("span",{style:{color:"green"},children:r.jsx("b",{children:e.row.CHECKSTATUS})}):r.jsx("span",{style:{color:"red"},children:r.jsx("b",{children:e.row.CHECKSTATUS})})}],c=e=>{e.key==="Enter"&&O()};function me(){return r.jsxs(V,{children:[r.jsx(z,{}),r.jsx(X,{}),r.jsx(Q,{}),r.jsx("button",{className:"saveexcelbutton",onClick:()=>{Y(l,"Uploaded Fcst")},children:"Save Excel"}),r.jsx(J,{})]})}function Se(){return r.jsxs(V,{children:[r.jsx(z,{}),r.jsx(X,{}),r.jsx(Q,{}),r.jsxs(w,{className:"buttonIcon",onClick:()=>{Y(y,"Fcst Table")},children:[r.jsx(Pe,{color:"green",size:25}),"SAVE"]}),r.jsxs(w,{className:"buttonIcon",onClick:()=>{b(d==null?void 0:d.EMPL_NO,d==null?void 0:d.MAINDEPTNAME,["KD"],Te)},children:[r.jsx(Le,{color:"red",size:25}),"XÓA FCST"]}),r.jsx(J,{}),r.jsxs(w,{className:"buttonIcon",onClick:()=>{L(!P)},children:[r.jsx(Oe,{color:"#ff33bb",size:25}),"Pivot"]})]})}const pe=e=>{if(e.preventDefault(),e.target.files){const a=new FileReader;a.onload=i=>{const n=i.target.result,M=Ke(n,{type:"array"}),je=M.SheetNames[0],Ne=M.Sheets[je],k=Me.sheet_to_json(Ne);let G=Object.keys(k[0]).map((t,R)=>({field:t,headerName:t,width:150}));G.push({field:"CHECKSTATUS",headerName:"CHECKSTATUS",width:350}),$(G),p(k.map((t,R)=>({...t,id:R,CHECKSTATUS:"Waiting",W1:t.W1===void 0||t.W1===""?0:t.W1,W2:t.W2===void 0||t.W2===""?0:t.W2,W3:t.W3===void 0||t.W3===""?0:t.W3,W4:t.W4===void 0||t.W4===""?0:t.W4,W5:t.W5===void 0||t.W5===""?0:t.W5,W6:t.W6===void 0||t.W6===""?0:t.W6,W7:t.W7===void 0||t.W7===""?0:t.W7,W8:t.W8===void 0||t.W8===""?0:t.W8,W9:t.W9===void 0||t.W9===""?0:t.W9,W10:t.W10===void 0||t.W10===""?0:t.W10,W11:t.W11===void 0||t.W11===""?0:t.W11,W12:t.W12===void 0||t.W12===""?0:t.W12,W13:t.W13===void 0||t.W13===""?0:t.W13,W14:t.W14===void 0||t.W14===""?0:t.W14,W15:t.W15===void 0||t.W15===""?0:t.W15,W16:t.W16===void 0||t.W16===""?0:t.W16,W17:t.W17===void 0||t.W17===""?0:t.W17,W18:t.W18===void 0||t.W18===""?0:t.W18,W19:t.W19===void 0||t.W19===""?0:t.W19,W20:t.W20===void 0||t.W20===""?0:t.W20,W21:t.W21===void 0||t.W21===""?0:t.W21,W22:t.W22===void 0||t.W22===""?0:t.W22,W1A:t.W1A===void 0||t.W1A===""?0:t.W1A,W2A:t.W2A===void 0||t.W2A===""?0:t.W2A,W3A:t.W3A===void 0||t.W3A===""?0:t.W3A,W4A:t.W4A===void 0||t.W4A===""?0:t.W4A,W5A:t.W5A===void 0||t.W5A===""?0:t.W5A,W6A:t.W6A===void 0||t.W6A===""?0:t.W6A,W7A:t.W7A===void 0||t.W7A===""?0:t.W7A,W8A:t.W8A===void 0||t.W8A===""?0:t.W8A,W9A:t.W9A===void 0||t.W9A===""?0:t.W9A,W10A:t.W10A===void 0||t.W10A===""?0:t.W10A,W11A:t.W11A===void 0||t.W11A===""?0:t.W11A,W12A:t.W12A===void 0||t.W12A===""?0:t.W12A,W13A:t.W13A===void 0||t.W13A===""?0:t.W13A,W14A:t.W14A===void 0||t.W14A===""?0:t.W14A,W15A:t.W15A===void 0||t.W15A===""?0:t.W15A,W16A:t.W16A===void 0||t.W16A===""?0:t.W16A,W17A:t.W17A===void 0||t.W17A===""?0:t.W17A,W18A:t.W18A===void 0||t.W18A===""?0:t.W18A,W19A:t.W19A===void 0||t.W19A===""?0:t.W19A,W20A:t.W20A===void 0||t.W20A===""?0:t.W20A,W21A:t.W21A===void 0||t.W21A===""?0:t.W21A,W22A:t.W22A===void 0||t.W22A===""?0:t.W22A})))},a.readAsArrayBuffer(e.target.files[0])}},O=()=>{u(!0),W("traFcstDataFull",{alltime:g,justPoBalance:oe,start_date:f,end_date:C,cust_name:j,codeCMS:T,codeKD:A,prod_type:N,empl_name:F,po_no:v,over:_,id:E,material:U}).then(e=>{if(e.data.tk_status!=="NG"){const a=e.data.data.map((i,n)=>({...i}));We(a),u(!1),s.fire("Thông báo","Đã load "+e.data.data.length+" dòng","success")}else s.fire("Thông báo","Nội dung: "+e.data.message,"error"),u(!1)}).catch(e=>{console.log(e)})},ge=async()=>{u(!0);let e=l;for(let a=0;a<l.length;a++){let i=0;await W("checkFcstExist",{FCSTYEAR:l[a].YEAR,FCSTWEEKNO:l[a].WEEKNO,G_CODE:l[a].G_CODE,CUST_CD:l[a].CUST_CD}).then(n=>{n.data.tk_status!=="NG"&&(i=1)}).catch(n=>{console.log(n)}),await W("checkGCodeVer",{G_CODE:l[a].G_CODE}).then(n=>{n.data.tk_status!=="NG"?n.data.data[0].USE_YN==="Y"||(i=3):i=4}).catch(n=>{console.log(n)}),i===0?e[a].CHECKSTATUS="OK":i===1?e[a].CHECKSTATUS="NG:FCST đã tồn tại":i===2?e[a].CHECKSTATUS="NG: Ngày FCST không được sau ngày hôm nay":i===3?e[a].CHECKSTATUS="NG: Ver này đã bị khóa":i===4?e[a].CHECKSTATUS="NG: Không có code CMS này":i===5&&(e[a].CHECKSTATUS="NG: Giao hàng nhiều hơn PO")}u(!1),s.fire("Thông báo","Đã hoàn thành check FCST hàng loạt","success"),p(e)},be=async()=>{u(!0);let e=l;for(let a=0;a<l.length;a++){let i=0;await W("checkFcstExist",{FCSTYEAR:l[a].YEAR,FCSTWEEKNO:l[a].WEEKNO,G_CODE:l[a].G_CODE,CUST_CD:l[a].CUST_CD}).then(n=>{n.data.tk_status!=="NG"&&(i=1)}).catch(n=>{console.log(n)}),await W("checkGCodeVer",{G_CODE:l[a].G_CODE}).then(n=>{n.data.tk_status!=="NG"?n.data.data[0].USE_YN==="Y"||(i=3):i=4}).catch(n=>{console.log(n)}),i===0?await W("insert_fcst",{EMPL_NO:l[a].EMPL_NO,CUST_CD:l[a].CUST_CD,G_CODE:l[a].G_CODE,PROD_PRICE:l[a].PROD_PRICE,YEAR:l[a].YEAR,WEEKNO:l[a].WEEKNO,W1:l[a].W1,W2:l[a].W2,W3:l[a].W3,W4:l[a].W4,W5:l[a].W5,W6:l[a].W6,W7:l[a].W7,W8:l[a].W8,W9:l[a].W9,W10:l[a].W10,W11:l[a].W11,W12:l[a].W12,W13:l[a].W13,W14:l[a].W14,W15:l[a].W15,W16:l[a].W16,W17:l[a].W17,W18:l[a].W18,W19:l[a].W19,W20:l[a].W20,W21:l[a].W21,W22:l[a].W22}).then(n=>{console.log(n.data.tk_status),n.data.tk_status!=="NG"?e[a].CHECKSTATUS="OK":(i=5,e[a].CHECKSTATUS="NG: Lỗi SQL: "+n.data.message)}).catch(n=>{console.log(n)}):i===1?e[a].CHECKSTATUS="NG:FCST đã tồn tại":i===2?e[a].CHECKSTATUS="NG: Ngày FCST không được sau ngày hôm nay":i===3?e[a].CHECKSTATUS="NG: Ver này đã bị khóa":i===4?e[a].CHECKSTATUS="NG: Không có code CMS này":i===5&&(e[a].CHECKSTATUS="NG: Giao hàng nhiều hơn PO")}u(!1),s.fire("Thông báo","Đã hoàn thành check Plan hàng loạt","success"),p(e)},xe=()=>{s.fire({title:"Chắc chắn muốn thêm FCST hàng loạt ?",text:"Thêm rồi mà sai, sửa là hơi vất đấy",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Vẫn thêm!"}).then(e=>{e.isConfirmed&&(s.fire("Tiến hành thêm","Đang thêm FCST hàng loạt","success"),be())})},fe=()=>{s.fire({title:"Chắc chắn muốn check FCST hàng loạt ?",text:"Sẽ bắt đầu check FCST hàng loạt",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Vẫn check!"}).then(e=>{e.isConfirmed&&(s.fire("Tiến hành check","Đang check FCST hàng loạt","success"),ge())})},K=e=>{e===1?S({...h,trapo:!0,thempohangloat:!1,them1po:!1,them1invoice:!1,testinvoicetable:!1}):e===2?S({...h,trapo:!1,thempohangloat:!0,them1po:!1,them1invoice:!1,testinvoicetable:!1}):e===3&&S({...h,trapo:!1,thempohangloat:!1,them1po:!1,them1invoice:!1,testinvoicetable:!0})},Ce=e=>{const a=new Set(e);let i=y.filter(n=>a.has(n.FCST_ID));i.length>0?D(i):D([])},Ae=async()=>{if(m.length>=1){let e=!1;for(let a=0;a<m.length;a++)m[a].EMPL_NO===(d==null?void 0:d.EMPL_NO)&&await W("delete_fcst",{FCST_ID:m[a].FCST_ID}).then(i=>{console.log(i.data.tk_status),i.data.tk_status!=="NG"||(e=!0)}).catch(i=>{console.log(i)});e?s.fire("Thông báo","Có lỗi SQL!","error"):s.fire("Thông báo","Xóa FCST thành công (chỉ FCST của người đăng nhập)!","success")}else s.fire("Thông báo","Chọn ít nhất 1 FCST để xóa !","error")},Te=()=>{s.fire({title:"Chắc chắn muốn xóa FCST đã chọn ?",text:"Sẽ chỉ xóa FCST do bạn up lên",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Vẫn Xóa!"}).then(e=>{e.isConfirmed&&(s.fire("Tiến hành Xóa","Đang Xóa FCST hàng loạt","success"),b(d==null?void 0:d.EMPL_NO,d==null?void 0:d.MAINDEPTNAME,["KD"],Ae))})},Fe=new ve({fields:[{caption:"FCST_ID",width:80,dataField:"FCST_ID",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"FCSTYEAR",width:80,dataField:"FCSTYEAR",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"FCSTWEEKNO",width:80,dataField:"FCSTWEEKNO",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"G_CODE",width:80,dataField:"G_CODE",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"G_NAME_KD",width:80,dataField:"G_NAME_KD",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"G_NAME",width:80,dataField:"G_NAME",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"EMPL_NAME",width:80,dataField:"EMPL_NAME",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"EMPL_NO",width:80,dataField:"EMPL_NO",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"CUST_NAME_KD",width:80,dataField:"CUST_NAME_KD",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"PROD_PROJECT",width:80,dataField:"PROD_PROJECT",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"PROD_MODEL",width:80,dataField:"PROD_MODEL",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"PROD_MAIN_MATERIAL",width:80,dataField:"PROD_MAIN_MATERIAL",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"PROD_PRICE",width:80,dataField:"PROD_PRICE",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W1",width:80,dataField:"W1",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W2",width:80,dataField:"W2",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W3",width:80,dataField:"W3",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W4",width:80,dataField:"W4",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W5",width:80,dataField:"W5",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W6",width:80,dataField:"W6",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W7",width:80,dataField:"W7",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W8",width:80,dataField:"W8",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W9",width:80,dataField:"W9",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W10",width:80,dataField:"W10",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W11",width:80,dataField:"W11",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W12",width:80,dataField:"W12",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W13",width:80,dataField:"W13",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W14",width:80,dataField:"W14",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W15",width:80,dataField:"W15",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W16",width:80,dataField:"W16",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W17",width:80,dataField:"W17",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W18",width:80,dataField:"W18",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W19",width:80,dataField:"W19",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W20",width:80,dataField:"W20",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W21",width:80,dataField:"W21",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W22",width:80,dataField:"W22",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W1A",width:80,dataField:"W1A",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"currency",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W2A",width:80,dataField:"W2A",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"currency",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W3A",width:80,dataField:"W3A",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"currency",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W4A",width:80,dataField:"W4A",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"currency",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W5A",width:80,dataField:"W5A",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"currency",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W6A",width:80,dataField:"W6A",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"currency",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W7A",width:80,dataField:"W7A",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"currency",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W8A",width:80,dataField:"W8A",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"currency",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W9A",width:80,dataField:"W9A",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"currency",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W10A",width:80,dataField:"W10A",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"currency",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W11A",width:80,dataField:"W11A",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"currency",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W12A",width:80,dataField:"W12A",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"currency",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W13A",width:80,dataField:"W13A",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"currency",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W14A",width:80,dataField:"W14A",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"currency",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W15A",width:80,dataField:"W15A",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"currency",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W16A",width:80,dataField:"W16A",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"currency",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W17A",width:80,dataField:"W17A",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"currency",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W18A",width:80,dataField:"W18A",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"currency",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W19A",width:80,dataField:"W19A",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"currency",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W20A",width:80,dataField:"W20A",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"currency",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W21A",width:80,dataField:"W21A",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"currency",headerFilter:{allowSearch:!0,height:500,width:300}},{caption:"W22A",width:80,dataField:"W22A",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"currency",headerFilter:{allowSearch:!0,height:500,width:300}}],store:y});return o.useEffect(()=>{},[]),r.jsxs("div",{className:"fcstmanager",children:[r.jsxs("div",{className:"mininavbar",children:[r.jsx("div",{className:"mininavitem",onClick:()=>K(1),style:{backgroundColor:h.trapo===!0?"#02c712":"#abc9ae",color:(h.trapo===!0,"yellow")},children:r.jsx("span",{className:"mininavtext",children:"Tra FCST"})}),r.jsx("div",{className:"mininavitem",onClick:()=>b(d==null?void 0:d.EMPL_NO,d==null?void 0:d.MAINDEPTNAME,["KD"],()=>{K(2)}),style:{backgroundColor:h.thempohangloat===!0?"#02c712":"#abc9ae",color:(h.thempohangloat===!0,"yellow")},children:r.jsx("span",{className:"mininavtext",children:"Thêm FCST"})})]}),h.thempohangloat&&r.jsx("div",{className:"newfcst",children:r.jsxs("div",{className:"batchnewplan",children:[r.jsx("h3",{children:"Thêm FCST Hàng Loạt"}),r.jsxs("form",{className:"formupload",children:[r.jsxs("label",{htmlFor:"upload",children:[r.jsx("b",{children:"Chọn file Excel: "}),r.jsx("input",{onKeyDown:e=>{c(e)},className:"selectfilebutton",type:"file",name:"upload",id:"upload",onChange:e=>{pe(e)}})]}),r.jsx("div",{className:"checkpobutton",onClick:e=>{e.preventDefault(),fe()},children:"Check FCST"}),r.jsx("div",{className:"uppobutton",onClick:e=>{e.preventDefault(),xe()},children:"Up FCST"})]}),r.jsx("div",{className:"insertPlanTable",children:r.jsx(B,{sx:{fontSize:"0.7rem"},components:{Toolbar:me,LoadingOverlay:H},loading:x,rowHeight:35,rows:l,columns:ye,rowsPerPageOptions:[5,10,50,100,500,1e3,5e3,1e4,1e5],editMode:"row"})})]})}),h.trapo&&r.jsxs("div",{className:"tracuuFcst",children:[r.jsxs("div",{className:"tracuuFcstform",children:[r.jsxs("div",{className:"forminput",children:[r.jsxs("div",{className:"forminputcolumn",children:[r.jsxs("label",{children:[r.jsx("b",{children:"Từ ngày:"}),r.jsx("input",{onKeyDown:e=>{c(e)},type:"date",value:f.slice(0,10),onChange:e=>Z(e.target.value)})]}),r.jsxs("label",{children:[r.jsx("b",{children:"Tới ngày:"})," ",r.jsx("input",{onKeyDown:e=>{c(e)},type:"date",value:C.slice(0,10),onChange:e=>q(e.target.value)})]})]}),r.jsxs("div",{className:"forminputcolumn",children:[r.jsxs("label",{children:[r.jsx("b",{children:"Code KD:"})," ",r.jsx("input",{onKeyDown:e=>{c(e)},type:"text",placeholder:"GH63-xxxxxx",value:A,onChange:e=>ee(e.target.value)})]}),r.jsxs("label",{children:[r.jsx("b",{children:"Code CMS:"})," ",r.jsx("input",{onKeyDown:e=>{c(e)},type:"text",placeholder:"7C123xxx",value:T,onChange:e=>re(e.target.value)})]})]}),r.jsxs("div",{className:"forminputcolumn",children:[r.jsxs("label",{children:[r.jsx("b",{children:"Tên nhân viên:"})," ",r.jsx("input",{onKeyDown:e=>{c(e)},type:"text",placeholder:"Trang",value:F,onChange:e=>te(e.target.value)})]}),r.jsxs("label",{children:[r.jsx("b",{children:"Khách:"})," ",r.jsx("input",{onKeyDown:e=>{c(e)},type:"text",placeholder:"SEVT",value:j,onChange:e=>ae(e.target.value)})]})]}),r.jsxs("div",{className:"forminputcolumn",children:[r.jsxs("label",{children:[r.jsx("b",{children:"Loại sản phẩm:"})," ",r.jsx("input",{onKeyDown:e=>{c(e)},type:"text",placeholder:"TSP",value:N,onChange:e=>le(e.target.value)})]}),r.jsxs("label",{children:[r.jsx("b",{children:"ID:"})," ",r.jsx("input",{onKeyDown:e=>{c(e)},type:"text",placeholder:"12345",value:E,onChange:e=>ie(e.target.value)})]})]}),r.jsxs("div",{className:"forminputcolumn",children:[r.jsxs("label",{children:[r.jsx("b",{children:"PO NO:"})," ",r.jsx("input",{onKeyDown:e=>{c(e)},type:"text",placeholder:"123abc",value:v,onChange:e=>de(e.target.value)})]}),r.jsxs("label",{children:[r.jsx("b",{children:"Vật liệu:"})," ",r.jsx("input",{onKeyDown:e=>{c(e)},type:"text",placeholder:"SJ-203020HC",value:U,onChange:e=>ce(e.target.value)})]})]}),r.jsxs("div",{className:"forminputcolumn",children:[r.jsxs("label",{children:[r.jsx("b",{children:"Over/OK:"})," ",r.jsx("input",{onKeyDown:e=>{c(e)},type:"text",placeholder:"OVER",value:_,onChange:e=>se(e.target.value)})]}),r.jsxs("label",{children:[r.jsx("b",{children:"Invoice No:"})," ",r.jsx("input",{onKeyDown:e=>{c(e)},type:"text",placeholder:"số invoice",value:he,onChange:e=>ue(e.target.value)})]})]})]}),r.jsxs("div",{className:"formbutton",children:[r.jsxs("label",{children:[r.jsx("b",{children:"All Time:"}),r.jsx("input",{onKeyDown:e=>{c(e)},type:"checkbox",name:"alltimecheckbox",defaultChecked:g,onChange:()=>ne(!g)})]}),r.jsxs(w,{className:"buttonIcon",onClick:()=>{O()},children:[r.jsx(Ue,{color:"green",size:30}),"Search"]})]})]}),r.jsx("div",{className:"tracuuFcstTable",children:r.jsx(B,{components:{Toolbar:Se,LoadingOverlay:H},sx:{fontSize:"0.7rem"},loading:x,rowHeight:30,rows:y,columns:we,rowsPerPageOptions:[5,10,50,100,500,1e3,5e3,1e4,1e5],editMode:"row",getRowId:e=>e.FCST_ID,checkboxSelection:!0,disableSelectionOnClick:!0,onSelectionModelChange:e=>{Ce(e)}})})]}),P&&r.jsxs("div",{className:"pivottable1",children:[r.jsxs(w,{className:"buttonIcon",onClick:()=>{L(!1)},children:[r.jsx(_e,{color:"blue",size:25}),"Close"]}),r.jsx(De,{datasource:Fe,tableID:"invoicetablepivot"})]})]})};export{ze as default};

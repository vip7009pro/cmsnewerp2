import{r as s,k as Et,ai as g,a_ as Pt,j as t,aT as A,aj as Ee,I as f,aV as xt,a$ as bt,b0 as St,ak as Pe,al as wt,br as Ct,bv as yt,aW as Dt,aZ as jt,aX as At,aY as vt,ad as T,S as c}from"./index-4ab6dde0.js";import{b as Mt}from"./index.esm-f9b137af.js";import{D as xe,A as K,G as be,b as Se,c as Lt}from"./DataGrid-b5e0acb2.js";import{T as O}from"./TextField-db9fe3d0.js";import{G as we,a as Ce,b as ye}from"./GridToolbarFilterButton-ec6062d3.js";import"./MenuItem-8199bc03.js";import"./Typography-b6d023f3.js";const Ht=()=>{const[De,je]=s.useTransition(),[_,p]=s.useState({trapo:!0,thempohangloat:!1,them1po:!1,them1invoice:!1}),l=Et(e=>e.totalSlice.userData),[u,I]=s.useState([]),[X,C]=s.useState(!1),[Ut,Ae]=s.useState([]),[J,ve]=s.useState(g().format("YYYY-MM-DD")),[Z,Me]=s.useState(g().format("YYYY-MM-DD")),[ee,Le]=s.useState(""),[te,Ue]=s.useState(""),[ae,Re]=s.useState(""),[le,Fe]=s.useState(""),[ne,ke]=s.useState(""),[oe,Ge]=s.useState(""),[Y,Ke]=s.useState(!0),[B,Ie]=s.useState(!0),[i,v]=s.useState(),[d,M]=s.useState(),[E,x]=s.useState(g().format("YYYY-MM-DD")),[y,b]=s.useState(g().format("YYYY-MM-DD")),[N,S]=s.useState(""),[H,Q]=s.useState(""),[D,j]=s.useState(""),[L,V]=s.useState(""),[U,z]=s.useState(0),[R,q]=s.useState(g().format("YYYY-MM-DD")),[ie,W]=s.useState(""),[w,Ye]=s.useState({total_po_qty:0,total_delivered_qty:0,total_pobalance_qty:0,total_po_amount:0,total_delivered_amount:0,total_pobalance_amount:0}),[re,Be]=s.useState([]),[se,He]=s.useState([]),[ce,Qe]=s.useState(""),[he,Ve]=s.useState(""),[de,ze]=s.useState(""),[qe,We]=s.useState(""),[F,$e]=s.useState([]),[n,ue]=s.useState([]),[Xe,me]=s.useState(),[ge,_e]=s.useState(!1),m=e=>{e.key==="Enter"&&Te()},Je=[{field:"CUST_NAME_KD",headerName:"CUST_NAME_KD",width:120},{field:"PO_NO",headerName:"PO_NO",width:110},{field:"G_NAME",headerName:"G_NAME",width:150},{field:"G_NAME_KD",headerName:"G_NAME_KD",width:120},{field:"G_CODE",headerName:"G_CODE",width:100},{field:"PO_DATE",type:"date",headerName:"PO_DATE",width:100},{field:"RD_DATE",type:"date",headerName:"RD_DATE",width:100},{field:"PROD_PRICE",type:"number",headerName:"PROD_PRICE",width:100,renderCell:e=>t.jsx("span",{style:{color:"gray"},children:t.jsx("b",{children:e.row.PROD_PRICE.toLocaleString("en-US",{style:"decimal",maximumFractionDigits:8})})})},{field:"PO_QTY",type:"number",headerName:"PO_QTY",width:100,renderCell:e=>t.jsx("span",{style:{color:"blue"},children:t.jsx("b",{children:e.row.PO_QTY.toLocaleString("en-US")})})},{field:"TOTAL_DELIVERED",type:"number",headerName:"TOTAL_DELIVERED",width:110,renderCell:e=>t.jsx("span",{style:{color:"blue"},children:t.jsx("b",{children:e.row.TOTAL_DELIVERED.toLocaleString("en-US")})})},{field:"PO_BALANCE",type:"number",headerName:"PO_BALANCE",width:100,renderCell:e=>t.jsx("span",{style:{color:"blue"},children:t.jsx("b",{children:e.row.PO_BALANCE.toLocaleString("en-US")})})},{field:"PO_AMOUNT",type:"number",headerName:"PO_AMOUNT",width:100,renderCell:e=>t.jsx("span",{style:{color:"green"},children:t.jsx("b",{children:e.row.PO_AMOUNT.toLocaleString("en-US",{style:"currency",currency:"USD"})})})},{field:"DELIVERED_AMOUNT",type:"number",headerName:"DELIVERED_AMOUNT",width:100,renderCell:e=>t.jsx("span",{style:{color:"green"},children:t.jsx("b",{children:e.row.DELIVERED_AMOUNT.toLocaleString("en-US",{style:"currency",currency:"USD"})})})},{field:"BALANCE_AMOUNT",type:"number",headerName:"BALANCE_AMOUNT",width:100,renderCell:e=>t.jsx("span",{style:{color:"green"},children:t.jsx("b",{children:e.row.BALANCE_AMOUNT.toLocaleString("en-US",{style:"currency",currency:"USD"})})})},{field:"TON_KIEM",type:"number",headerName:"TON_KIEM",width:100,renderCell:e=>t.jsx("span",{children:e.row.TON_KIEM.toLocaleString("en-US")})},{field:"BTP",type:"number",headerName:"BTP",width:90,renderCell:e=>t.jsx("span",{children:e.row.BTP.toLocaleString("en-US")})},{field:"TP",type:"number",headerName:"TP",width:90,renderCell:e=>t.jsx("span",{children:e.row.TP.toLocaleString("en-US")})},{field:"BLOCK_QTY",type:"number",headerName:"BLOCK_QTY",width:90,renderCell:e=>t.jsx("span",{children:e.row.BLOCK_QTY.toLocaleString("en-US")})},{field:"GRAND_TOTAL_STOCK",type:"number",headerName:"GRAND_TOTAL_STOCK",width:90,renderCell:e=>t.jsx("span",{children:t.jsx("b",{children:e.row.GRAND_TOTAL_STOCK.toLocaleString("en-US")})})},{field:"EMPL_NAME",headerName:"EMPL_NAME",width:150},{field:"PROD_TYPE",headerName:"PROD_TYPE",width:90},{field:"M_NAME_FULLBOM",headerName:"M_NAME_FULLBOM",width:110},{field:"PROD_MAIN_MATERIAL",headerName:"PROD_MAIN_MATERIAL",width:110},{field:"POMONTH",type:"number",headerName:"POMONTH",width:80},{field:"POWEEKNUM",type:"number",headerName:"POWEEKNUM",width:80},{field:"OVERDUE",headerName:"OVERDUE",width:80},{field:"REMARK",headerName:"REMARK",width:110},{field:"PO_ID",type:"number",headerName:"PO_ID",width:90}],Ze=[{field:"CUST_CD",headerName:"CUST_CD",width:120},{field:"G_CODE",headerName:"G_CODE",width:120},{field:"PO_NO",headerName:"PO_NO",width:120},{field:"PO_QTY",type:"number",headerName:"PO_QTY",width:120,renderCell:e=>t.jsx("span",{style:{color:"blue"},children:t.jsx("b",{children:e.row.PO_QTY.toLocaleString("en-US")})})},{field:"PO_DATE",headerName:"PO_DATE",width:200},{field:"RD_DATE",headerName:"RD_DATE",width:200},{field:"PROD_PRICE",type:"number",headerName:"PROD_PRICE",width:200,renderCell:e=>t.jsx("span",{style:{color:"gray"},children:t.jsx("b",{children:e.row.PROD_PRICE.toLocaleString("en-US",{style:"decimal",maximumFractionDigits:8})})})},{field:"CHECKSTATUS",headerName:"CHECKSTATUS",width:200,renderCell:e=>e.row.CHECKSTATUS.slice(0,2)==="OK"?t.jsx("span",{style:{color:"green"},children:t.jsx("b",{children:e.row.CHECKSTATUS})}):t.jsx("span",{style:{color:"red"},children:t.jsx("b",{children:e.row.CHECKSTATUS})})}];function et(){return t.jsxs(be,{children:[t.jsx(we,{}),t.jsx(Ce,{}),t.jsx(ye,{}),t.jsx("button",{className:"saveexcelbutton",onClick:()=>{Pe(u,"Uploaded PO")},children:"Save Excel"}),t.jsx(Se,{})]})}const tt=()=>{p({..._,trapo:!0,thempohangloat:!1,them1po:!_.them1po,them1invoice:!1})};function at(){return t.jsxs(be,{children:[t.jsx(we,{}),t.jsx(Ce,{}),t.jsx(ye,{}),t.jsxs(f,{className:"buttonIcon",onClick:()=>{Pe(F,"PO Table")},children:[t.jsx(wt,{color:"green",size:25}),"SAVE"]}),t.jsxs(f,{className:"buttonIcon",onClick:()=>{A(l==null?void 0:l.EMPL_NO,l==null?void 0:l.MAINDEPTNAME,["KD"],tt),k()},children:[t.jsx(Ct,{color:"blue",size:25}),"NEW PO"]}),t.jsxs(f,{className:"buttonIcon",onClick:()=>{A(l==null?void 0:l.EMPL_NO,l==null?void 0:l.MAINDEPTNAME,["KD"],_t)},children:[t.jsx(Mt,{color:"lightgreen",size:25}),"NEW INV"]}),t.jsxs(f,{className:"buttonIcon",onClick:()=>{A(l==null?void 0:l.EMPL_NO,l==null?void 0:l.MAINDEPTNAME,["KD"],gt)},children:[t.jsx(yt,{color:"orange",size:25}),"SỬA PO"]}),t.jsxs(f,{className:"buttonIcon",onClick:()=>{A(l==null?void 0:l.EMPL_NO,l==null?void 0:l.MAINDEPTNAME,["KD"],Nt)},children:[t.jsx(Dt,{color:"red",size:25}),"XÓA PO"]}),t.jsx(Se,{}),t.jsxs(f,{className:"buttonIcon",onClick:()=>{_e(!ge)},children:[t.jsx(jt,{color:"#ff33bb",size:25}),"Pivot"]})]})}const lt=e=>{if(e.preventDefault(),e.target.files){const a=new FileReader;a.onload=r=>{const o=r.target.result,P=At(o,{type:"array"}),h=P.SheetNames[0],ft=P.Sheets[h],Ne=vt.sheet_to_json(ft);let pe=Object.keys(Ne[0]).map((G,fe)=>({field:G,headerName:G,width:150}));pe.push({field:"CHECKSTATUS",headerName:"CHECKSTATUS",width:350}),Ae(pe),I(Ne.map((G,fe)=>({...G,id:fe,CHECKSTATUS:"Waiting"})))},a.readAsArrayBuffer(e.target.files[0])}},Te=()=>{C(!0),T("traPODataFull",{alltime:Y,justPoBalance:B,start_date:J,end_date:Z,cust_name:le,codeCMS:te,codeKD:ee,prod_type:ne,empl_name:ae,po_no:ce,over:de,id:oe,material:he}).then(e=>{if(e.data.tk_status!=="NG"){const a=e.data.data.map((o,P)=>({...o,PO_DATE:o.PO_DATE.slice(0,10),RD_DATE:o.RD_DATE.slice(0,10)}));let r={total_po_qty:0,total_delivered_qty:0,total_pobalance_qty:0,total_po_amount:0,total_delivered_amount:0,total_pobalance_amount:0};for(let o=0;o<a.length;o++)r.total_po_qty+=a[o].PO_QTY,r.total_delivered_qty+=a[o].TOTAL_DELIVERED,r.total_pobalance_qty+=a[o].PO_BALANCE,r.total_po_amount+=a[o].PO_AMOUNT,r.total_delivered_amount+=a[o].DELIVERED_AMOUNT,r.total_pobalance_amount+=a[o].BALANCE_AMOUNT;Ye(r),$e(a),C(!1),c.fire("Thông báo","Đã load "+e.data.data.length+" dòng","success")}else c.fire("Thông báo","Nội dung: "+e.data.message,"error"),C(!1)}).catch(e=>{console.log(e)})},nt=async()=>{C(!0);let e=u;for(let a=0;a<u.length;a++){let r=0;await T("checkPOExist",{G_CODE:u[a].G_CODE,CUST_CD:u[a].CUST_CD,PO_NO:u[a].PO_NO}).then(h=>{console.log(h.data.tk_status),h.data.tk_status!=="NG"&&(r=1)}).catch(h=>{console.log(h)});let o=g(),P=g(u[a].PO_DATE);o<P&&(r=2),await T("checkGCodeVer",{G_CODE:u[a].G_CODE}).then(h=>{h.data.tk_status!=="NG"?(console.log(h.data.data),h.data.data[0].USE_YN==="Y"||(r=3)):r=4}).catch(h=>{console.log(h)}),r===0?e[a].CHECKSTATUS="OK":r===1?e[a].CHECKSTATUS="NG: Đã tồn tại PO":r===2?e[a].CHECKSTATUS="NG: Ngày PO không được trước ngày hôm nay":r===3?e[a].CHECKSTATUS="NG: Ver này đã bị khóa":r===4&&(e[a].CHECKSTATUS="NG: Không có code CMS này")}C(!1),c.fire("Thông báo","Đã hoàn thành check PO hàng loạt","success"),I(e)},ot=async()=>{let e=u;for(let a=0;a<u.length;a++){let r=0;await T("checkPOExist",{G_CODE:u[a].G_CODE,CUST_CD:u[a].CUST_CD,PO_NO:u[a].PO_NO}).then(h=>{console.log(h.data.tk_status),h.data.tk_status!=="NG"&&(r=1)}).catch(h=>{console.log(h)});let o=g(),P=g(u[a].PO_DATE);o<P&&(r=2),await T("checkGCodeVer",{G_CODE:u[a].G_CODE}).then(h=>{console.log(h.data.tk_status),h.data.tk_status!=="NG"?(console.log(h.data.data),h.data.data[0].USE_YN==="Y"||(r=3)):r=4}).catch(h=>{console.log(h)}),r===0?await T("insert_po",{G_CODE:u[a].G_CODE,CUST_CD:u[a].CUST_CD,PO_NO:u[a].PO_NO,EMPL_NO:l==null?void 0:l.EMPL_NO,PO_QTY:u[a].PO_QTY,PO_DATE:u[a].PO_DATE,RD_DATE:u[a].RD_DATE,PROD_PRICE:u[a].PROD_PRICE,REMARK:u[a].REMARK}).then(h=>{console.log(h.data.tk_status),h.data.tk_status!=="NG"?e[a].CHECKSTATUS="OK":(r=5,e[a].CHECKSTATUS="NG: Lỗi SQL: "+h.data.message)}).catch(h=>{console.log(h)}):r===1?e[a].CHECKSTATUS="NG: Đã tồn tại PO":r===2?e[a].CHECKSTATUS="NG: Ngày PO không được trước ngày hôm nay":r===3?e[a].CHECKSTATUS="NG: Ver này đã bị khóa":r===4&&(e[a].CHECKSTATUS="NG: Không có code CMS này")}c.fire("Thông báo","Đã hoàn thành thêm PO hàng loạt","success"),I(e)},it=()=>{c.fire({title:"Chắc chắn muốn thêm PO hàng loạt ?",text:"Thêm rồi mà sai, sửa là hơi vất đấy",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Vẫn thêm!"}).then(e=>{e.isConfirmed&&(c.fire("Tiến hành thêm","Đang thêm PO hàng loạt","success"),ot())})},rt=()=>{c.fire({title:"Chắc chắn muốn check PO hàng loạt ?",text:"Sẽ bắt đầu check po hàng loạt",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Vẫn check!"}).then(e=>{e.isConfirmed&&(c.fire("Tiến hành check","Đang check PO hàng loạt","success"),nt())})},st=()=>{T("selectcustomerList",{}).then(e=>{e.data.tk_status!=="NG"&&Be(e.data.data)}).catch(e=>{console.log(e)})},ct=e=>{T("selectcodeList",{G_NAME:e}).then(a=>{a.data.tk_status!=="NG"&&(De||je(()=>{He(a.data.data)}))}).catch(a=>{console.log(a)})},Oe=e=>{e===1?p({..._,trapo:!0,thempohangloat:!1,them1po:!1,them1invoice:!1}):e===2?p({..._,trapo:!1,thempohangloat:!0,them1po:!1,them1invoice:!1}):e===3&&p({..._,trapo:!1,thempohangloat:!1,them1po:!0,them1invoice:!1})},ht=async()=>{let e=0;await T("checkPOExist",{G_CODE:i==null?void 0:i.G_CODE,CUST_CD:d==null?void 0:d.CUST_CD,PO_NO:N}).then(o=>{console.log(o.data.tk_status),o.data.tk_status!=="NG"&&(e=1)}).catch(o=>{console.log(o)});let a=g(),r=g(E);a<r&&(e=2),(i==null?void 0:i.USE_YN)==="N"&&(e=3),((i==null?void 0:i.G_CODE)===""||(d==null?void 0:d.CUST_CD)===""||N===""||(l==null?void 0:l.EMPL_NO)===""||D==="")&&(e=4),e===0?await T("insert_po",{G_CODE:i==null?void 0:i.G_CODE,CUST_CD:d==null?void 0:d.CUST_CD,PO_NO:N,EMPL_NO:l==null?void 0:l.EMPL_NO,PO_QTY:H,PO_DATE:E,RD_DATE:y,PROD_PRICE:D,REMARK:L===void 0?"":L}).then(o=>{console.log(o.data.tk_status),o.data.tk_status!=="NG"?c.fire("Thông báo","Thêm PO mới thành công","success"):c.fire("Thông báo","Thêm PO mới thất bại: "+o.data.message,"error")}).catch(o=>{console.log(o)}):e===1?c.fire("Thông báo","NG: Đã tồn tại PO","error"):e===2?c.fire("Thông báo","NG: Ngày PO không được trước ngày hôm nay","error"):e===3?c.fire("Thông báo","NG: Ver này đã bị khóa","error"):e===4&&c.fire("Thông báo","NG: Không để trống thông tin bắt buộc","error")},dt=async()=>{let e=0;await T("checkPOExist",{G_CODE:i==null?void 0:i.G_CODE,CUST_CD:d==null?void 0:d.CUST_CD,PO_NO:N}).then(o=>{console.log(o.data.tk_status),o.data.tk_status!=="NG"||(e=1)}).catch(o=>{console.log(o)});let a=g(),r=g(R);a<r&&(e=2),(i==null?void 0:i.USE_YN)==="N"&&(e=3),((i==null?void 0:i.G_CODE)===""||(d==null?void 0:d.CUST_CD)===""||R===""||(l==null?void 0:l.EMPL_NO)===""||U===0)&&(e=4),(i==null?void 0:i.PO_BALANCE)!==void 0&&(c.fire("Thông báo","PO BALANCE: "+(i==null?void 0:i.PO_BALANCE),"success"),(i==null?void 0:i.PO_BALANCE)<U&&(e=5)),e===0?await T("insert_invoice",{G_CODE:i==null?void 0:i.G_CODE,CUST_CD:d==null?void 0:d.CUST_CD,PO_NO:N,EMPL_NO:l==null?void 0:l.EMPL_NO,DELIVERY_QTY:U,PO_DATE:E,RD_DATE:y,DELIVERY_DATE:R,REMARK:ie}).then(o=>{console.log(o.data.tk_status),o.data.tk_status!=="NG"?c.fire("Thông báo","Thêm Invoice mới thành công","success"):c.fire("Thông báo","Thêm Invoice mới thất bại: "+o.data.message,"error")}).catch(o=>{console.log(o)}):e===1?c.fire("Thông báo","NG: Không tồn tại PO","error"):e===2?c.fire("Thông báo","NG: Ngày Invoice không được trước ngày hôm nay","error"):e===3?c.fire("Thông báo","NG: Ver này đã bị khóa","error"):e===4?c.fire("Thông báo","NG: Không để trống thông tin bắt buộc","error"):e===5&&c.fire("Thông báo","NG: Invoice QTY nhiều hơn PO BALANCE","error")},k=()=>{x(g().format("YYYY-MM-DD")),b(g().format("YYYY-MM-DD")),S(""),Q(""),j(""),V("")},ut=()=>{x(g().format("YYYY-MM-DD")),b(g().format("YYYY-MM-DD")),S(""),z(0),q(""),W("")},mt=e=>{const a=new Set(e);let r=F.filter(o=>a.has(o.PO_ID));r.length>0?ue(r):ue([])},gt=()=>{if(n.length===1){p({..._,trapo:!0,thempohangloat:!1,them1po:!_.them1po});const e={G_CODE:n[n.length-1].G_CODE,G_NAME:n[n.length-1].G_NAME,PROD_LAST_PRICE:Number(n[n.length-1].PROD_PRICE),USE_YN:"Y",PO_BALANCE:Number(n[n.length-1].PO_BALANCE)},a={CUST_CD:n[n.length-1].CUST_CD,CUST_NAME_KD:n[n.length-1].CUST_NAME_KD};v(e),M(a),x(n[n.length-1].PO_DATE),b(n[n.length-1].RD_DATE),Q(n[n.length-1].PO_QTY.toString()),S(n[n.length-1].PO_NO),j(n[n.length-1].PROD_PRICE),V(n[n.length-1].REMARK),me(n[n.length-1].PO_ID)}else n.length===0?(k(),c.fire("Thông báo","Lỗi: Chọn ít nhất 1 PO để sửa","error")):c.fire("Thông báo","Lỗi: Chỉ tích chọn 1 dòng để sửa thôi","error")},_t=()=>{if(n.length===1){p({..._,trapo:!0,thempohangloat:!1,them1po:!1,them1invoice:!0});const e={G_CODE:n[n.length-1].G_CODE,G_NAME:n[n.length-1].G_NAME,PROD_LAST_PRICE:Number(n[n.length-1].PROD_PRICE),USE_YN:"Y",PO_BALANCE:Number(n[n.length-1].PO_BALANCE)},a={CUST_CD:n[n.length-1].CUST_CD,CUST_NAME_KD:n[n.length-1].CUST_NAME_KD};v(e),M(a),x(n[n.length-1].PO_DATE),b(n[n.length-1].RD_DATE),z(0),S(n[n.length-1].PO_NO),q(g().add(-1,"day").format("YYYY-MM-DD")),W(""),me(n[n.length-1].PO_ID)}else n.length===0?(k(),c.fire("Thông báo","Lỗi: Chọn ít nhất 1 PO để thêm invoice","error")):c.fire("Thông báo","Lỗi: Chỉ tích chọn 1 dòng thêm thôi","error")},Tt=async()=>{let e=0;await T("checkPOExist",{G_CODE:i==null?void 0:i.G_CODE,CUST_CD:d==null?void 0:d.CUST_CD,PO_NO:N}).then(o=>{console.log(o.data.tk_status),o.data.tk_status!=="NG"||(e=1)}).catch(o=>{console.log(o)});let a=g(),r=g(E);a<r&&(e=2),(i==null?void 0:i.USE_YN)==="N"&&(e=3),((i==null?void 0:i.G_CODE)===""||(d==null?void 0:d.CUST_CD)===""||N===""||(l==null?void 0:l.EMPL_NO)===""||D==="")&&(e=4),e===0?await T("update_po",{G_CODE:i==null?void 0:i.G_CODE,CUST_CD:d==null?void 0:d.CUST_CD,PO_NO:N,EMPL_NO:l==null?void 0:l.EMPL_NO,PO_QTY:H,PO_DATE:E,RD_DATE:y,PROD_PRICE:D,REMARK:L,PO_ID:Xe}).then(o=>{console.log(o.data.tk_status),o.data.tk_status!=="NG"?c.fire("Thông báo","Update Po thành công","success"):c.fire("Thông báo","Update PO thất bại: "+o.data.message,"error")}).catch(o=>{console.log(o)}):e===1?c.fire("Thông báo","NG: Không tồn tại PO","error"):e===2?c.fire("Thông báo","NG: Ngày PO không được trước ngày hôm nay","error"):e===3?c.fire("Thông báo","NG: Ver này đã bị khóa","error"):e===4?c.fire("Thông báo","NG: Không để trống thông tin bắt buộc","error"):c.fire("Thông báo","Kiểm tra xem PO có giao hàng chưa?","error")},Ot=async()=>{if(n.length>=1){let e=!1;for(let a=0;a<n.length;a++)n[a].EMPL_NO===(l==null?void 0:l.EMPL_NO)&&await T("delete_po",{PO_ID:n[a].PO_ID}).then(r=>{console.log(r.data.tk_status),r.data.tk_status!=="NG"||(e=!0)}).catch(r=>{console.log(r)});e?c.fire("Thông báo","Có lỗi, khả năng xóa phải PO đã có phát sinh giao hàng!","error"):c.fire("Thông báo","Xóa PO thành công (chỉ PO của người đăng nhập)!","success")}else c.fire("Thông báo","Chọn ít nhất 1 PO để xóa !","error")},Nt=()=>{c.fire({title:"Chắc chắn muốn xóa PO đã chọn ?",text:"Sẽ bắt đầu xóa po đã chọn",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Vẫn Xóa!"}).then(e=>{e.isConfirmed&&(c.fire("Tiến hành Xóa","Đang Xóa PO hàng loạt","success"),Ot())})},$=Lt({matchFrom:"any",limit:100}),pt=new Pt({fields:[{caption:"PO_ID",width:80,dataField:"PO_ID",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"CUST_NAME_KD",width:80,dataField:"CUST_NAME_KD",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"PO_NO",width:80,dataField:"PO_NO",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"G_NAME",width:80,dataField:"G_NAME",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"G_NAME_KD",width:80,dataField:"G_NAME_KD",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"G_CODE",width:80,dataField:"G_CODE",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"PO_DATE",width:80,dataField:"PO_DATE",allowSorting:!0,allowFiltering:!0,dataType:"date",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"RD_DATE",width:80,dataField:"RD_DATE",allowSorting:!0,allowFiltering:!0,dataType:"date",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"PROD_PRICE",width:80,dataField:"PROD_PRICE",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"PO_QTY",width:80,dataField:"PO_QTY",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"TOTAL_DELIVERED",width:80,dataField:"TOTAL_DELIVERED",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"PO_BALANCE",width:80,dataField:"PO_BALANCE",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"PO_AMOUNT",width:80,dataField:"PO_AMOUNT",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"currency",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"DELIVERED_AMOUNT",width:80,dataField:"DELIVERED_AMOUNT",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"currency",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"BALANCE_AMOUNT",width:80,dataField:"BALANCE_AMOUNT",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"currency",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"TON_KIEM",width:80,dataField:"TON_KIEM",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"BTP",width:80,dataField:"BTP",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"TP",width:80,dataField:"TP",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"BLOCK_QTY",width:80,dataField:"BLOCK_QTY",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"GRAND_TOTAL_STOCK",width:80,dataField:"GRAND_TOTAL_STOCK",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"sum",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"EMPL_NAME",width:80,dataField:"EMPL_NAME",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"PROD_TYPE",width:80,dataField:"PROD_TYPE",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"M_NAME_FULLBOM",width:80,dataField:"M_NAME_FULLBOM",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"PROD_MAIN_MATERIAL",width:80,dataField:"PROD_MAIN_MATERIAL",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"CUST_CD",width:80,dataField:"CUST_CD",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"EMPL_NO",width:80,dataField:"EMPL_NO",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"POMONTH",width:80,dataField:"POMONTH",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"POWEEKNUM",width:80,dataField:"POWEEKNUM",allowSorting:!0,allowFiltering:!0,dataType:"number",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"OVERDUE",width:80,dataField:"OVERDUE",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:250}},{caption:"REMARK",width:80,dataField:"REMARK",allowSorting:!0,allowFiltering:!0,dataType:"string",summaryType:"count",format:"fixedPoint",headerFilter:{allowSearch:!0,height:500,width:250}}],store:F});return s.useEffect(()=>{st(),ct("")},[]),t.jsxs("div",{className:"pomanager",children:[t.jsxs("div",{className:"mininavbar",children:[t.jsx("div",{className:"mininavitem",onClick:()=>Oe(1),style:{backgroundColor:_.trapo===!0?"#02c712":"#abc9ae",color:(_.trapo===!0,"yellow")},children:t.jsx("span",{className:"mininavtext",children:"Tra PO"})}),t.jsx("div",{className:"mininavitem",onClick:()=>A(l==null?void 0:l.EMPL_NO,l==null?void 0:l.MAINDEPTNAME,["KD"],()=>{Oe(2)}),style:{backgroundColor:_.thempohangloat===!0?"#02c712":"#abc9ae",color:(_.thempohangloat===!0,"yellow")},children:t.jsx("span",{className:"mininavtext",children:"Thêm PO"})})]}),_.thempohangloat&&t.jsxs("div",{className:"newpo",children:[t.jsxs("div",{className:"batchnewpo",children:[t.jsx("h3",{children:"Thêm PO Hàng Loạt"}),t.jsxs("div",{className:"formupload",children:[t.jsxs("label",{htmlFor:"upload",children:[t.jsx("b",{children:"Chọn file Excel: "}),t.jsx("input",{onKeyDown:e=>{m(e)},className:"selectfilebutton",type:"file",name:"upload",id:"upload",onChange:e=>{lt(e)}})]}),t.jsx("div",{className:"checkpobutton",onClick:e=>{e.preventDefault(),rt()},children:"Check PO"}),t.jsx("div",{className:"uppobutton",onClick:e=>{e.preventDefault(),it()},children:"Up PO"})]}),t.jsx("div",{className:"insertPOTable",children:t.jsx(xe,{sx:{fontSize:"0.6rem"},components:{Toolbar:et,LoadingOverlay:Ee},loading:X,rowHeight:35,rows:u,columns:Ze,rowsPerPageOptions:[5,10,50,100,500,1e3,5e3,1e4,1e5],editMode:"row",getRowHeight:()=>"auto"})})]}),t.jsx("div",{className:"singlenewpo"})]}),_.trapo&&t.jsxs("div",{className:"tracuuPO",children:[t.jsxs("div",{className:"tracuuPOform",children:[t.jsxs("div",{className:"forminput",children:[t.jsxs("div",{className:"forminputcolumn",children:[t.jsxs("label",{children:[t.jsx("b",{children:"Từ ngày:"}),t.jsx("input",{onKeyDown:e=>{m(e)},type:"date",value:J.slice(0,10),onChange:e=>ve(e.target.value)})]}),t.jsxs("label",{children:[t.jsx("b",{children:"Tới ngày:"})," ",t.jsx("input",{onKeyDown:e=>{m(e)},type:"date",value:Z.slice(0,10),onChange:e=>Me(e.target.value)})]})]}),t.jsxs("div",{className:"forminputcolumn",children:[t.jsxs("label",{children:[t.jsx("b",{children:"Code KD:"})," ",t.jsx("input",{onKeyDown:e=>{m(e)},type:"text",placeholder:"GH63-xxxxxx",value:ee,onChange:e=>Le(e.target.value)})]}),t.jsxs("label",{children:[t.jsx("b",{children:"Code CMS:"})," ",t.jsx("input",{onKeyDown:e=>{m(e)},type:"text",placeholder:"7C123xxx",value:te,onChange:e=>Ue(e.target.value)})]})]}),t.jsxs("div",{className:"forminputcolumn",children:[t.jsxs("label",{children:[t.jsx("b",{children:"Tên nhân viên:"})," ",t.jsx("input",{onKeyDown:e=>{m(e)},type:"text",placeholder:"Trang",value:ae,onChange:e=>Re(e.target.value)})]}),t.jsxs("label",{children:[t.jsx("b",{children:"Khách:"})," ",t.jsx("input",{onKeyDown:e=>{m(e)},type:"text",placeholder:"SEVT",value:le,onChange:e=>Fe(e.target.value)})]})]}),t.jsxs("div",{className:"forminputcolumn",children:[t.jsxs("label",{children:[t.jsx("b",{children:"Loại sản phẩm:"})," ",t.jsx("input",{onKeyDown:e=>{m(e)},type:"text",placeholder:"TSP",value:ne,onChange:e=>ke(e.target.value)})]}),t.jsxs("label",{children:[t.jsx("b",{children:"ID:"})," ",t.jsx("input",{onKeyDown:e=>{m(e)},type:"text",placeholder:"12345",value:oe,onChange:e=>Ge(e.target.value)})]})]}),t.jsxs("div",{className:"forminputcolumn",children:[t.jsxs("label",{children:[t.jsx("b",{children:"PO NO:"})," ",t.jsx("input",{onKeyDown:e=>{m(e)},type:"text",placeholder:"123abc",value:ce,onChange:e=>Qe(e.target.value)})]}),t.jsxs("label",{children:[t.jsx("b",{children:"Vật liệu:"})," ",t.jsx("input",{onKeyDown:e=>{m(e)},type:"text",placeholder:"SJ-203020HC",value:he,onChange:e=>Ve(e.target.value)})]})]}),t.jsxs("div",{className:"forminputcolumn",children:[t.jsxs("label",{children:[t.jsx("b",{children:"Over/OK:"})," ",t.jsx("input",{onKeyDown:e=>{m(e)},type:"text",placeholder:"OVER",value:de,onChange:e=>ze(e.target.value)})]}),t.jsxs("label",{children:[t.jsx("b",{children:"Invoice No:"})," ",t.jsx("input",{onKeyDown:e=>{m(e)},type:"text",placeholder:"số invoice",value:qe,onChange:e=>We(e.target.value)})]})]})]}),t.jsxs("div",{className:"formbutton",children:[t.jsxs("label",{children:[t.jsx("b",{children:"All Time:"}),t.jsx("input",{onKeyDown:e=>{m(e)},type:"checkbox",name:"alltimecheckbox",defaultChecked:Y,onChange:()=>Ke(!Y)})]}),t.jsxs("label",{children:[t.jsx("b",{children:"Chỉ PO Tồn:"}),t.jsx("input",{onKeyDown:e=>{m(e)},type:"checkbox",name:"pobalancecheckbox",defaultChecked:B,onChange:()=>Ie(!B)})]}),t.jsxs(f,{className:"buttonIcon",onClick:()=>{Te()},children:[t.jsx(xt,{color:"green",size:30}),"Search"]})]}),t.jsx("div",{className:"formsummary",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("td",{children:"PO QTY"}),t.jsx("td",{children:"DELIVERED QTY"}),t.jsx("td",{children:"PO BALANCE QTY"}),t.jsx("td",{children:"PO AMOUNT"}),t.jsx("td",{children:"DELIVERED AMOUNT"}),t.jsx("td",{children:"PO BALANCE AMOUNT"})]})}),t.jsx("tbody",{children:t.jsxs("tr",{children:[t.jsxs("td",{style:{color:"purple",fontWeight:"bold"},children:[w.total_po_qty.toLocaleString("en-US")," EA"]}),t.jsxs("td",{style:{color:"purple",fontWeight:"bold"},children:[" ",w.total_delivered_qty.toLocaleString("en-US")," EA"]}),t.jsxs("td",{style:{color:"purple",fontWeight:"bold"},children:[" ",w.total_pobalance_qty.toLocaleString("en-US")," EA"]}),t.jsxs("td",{style:{color:"blue",fontWeight:"bold"},children:[" ",w.total_po_amount.toLocaleString("en-US",{style:"currency",currency:"USD"})]}),t.jsxs("td",{style:{color:"blue",fontWeight:"bold"},children:[" ",w.total_delivered_amount.toLocaleString("en-US",{style:"currency",currency:"USD"})]}),t.jsxs("td",{style:{color:"blue",fontWeight:"bold"},children:[" ",w.total_pobalance_amount.toLocaleString("en-US",{style:"currency",currency:"USD"})]})]})})]})})]}),t.jsx("div",{className:"tracuuPOTable",children:t.jsx(xe,{sx:{fontSize:"0.7rem",flex:1},components:{Toolbar:at,LoadingOverlay:Ee},loading:X,rowHeight:30,rows:F,columns:Je,rowsPerPageOptions:[5,10,50,100,500,1e3,5e3,1e4,1e5],editMode:"row",getRowId:e=>e.PO_ID,checkboxSelection:!0,disableSelectionOnClick:!0,onSelectionModelChange:e=>{mt(e)}})})]}),_.them1po&&t.jsx("div",{className:"them1po",children:t.jsx("div",{className:"formnho",children:t.jsxs("div",{className:"dangkyform",children:[t.jsx("h3",{children:"Thêm PO mới"}),t.jsxs("div",{className:"dangkyinput",children:[t.jsxs("div",{className:"dangkyinputbox",children:[t.jsxs("label",{children:[t.jsx("b",{children:"Khách hàng:"})," ",t.jsx(K,{size:"small",disablePortal:!0,options:re,className:"autocomplete",filterOptions:$,isOptionEqualToValue:(e,a)=>e.CUST_CD===a.CUST_CD,getOptionLabel:e=>`${e.CUST_CD}: ${e.CUST_NAME_KD}`,renderInput:e=>t.jsx(O,{...e,label:"Select customer"}),value:d,onChange:(e,a)=>{console.log(a),M(a)}})]}),t.jsxs("label",{children:[t.jsx("b",{children:"Code hàng:"})," ",t.jsx(K,{size:"small",disablePortal:!0,options:se,className:"autocomplete",filterOptions:$,isOptionEqualToValue:(e,a)=>e.G_CODE===a.G_CODE,getOptionLabel:e=>`${e.G_CODE}: ${e.G_NAME}`,renderInput:e=>t.jsx(O,{...e,label:"Select code"}),onChange:(e,a)=>{console.log(a),j(a===null?"":a.PROD_LAST_PRICE.toString()),v(a)},value:i})]}),t.jsxs("label",{children:[t.jsx("b",{children:"PO Date:"}),t.jsx("input",{onKeyDown:e=>{m(e)},className:"inputdata",type:"date",value:E.slice(0,10),onChange:e=>x(e.target.value)})]}),t.jsxs("label",{children:[t.jsx("b",{children:"RD Date:"})," ",t.jsx("input",{onKeyDown:e=>{m(e)},className:"inputdata",type:"date",value:y.slice(0,10),onChange:e=>b(e.target.value)})]})]}),t.jsxs("div",{className:"dangkyinputbox",children:[t.jsxs("label",{children:[t.jsx("b",{children:"PO NO:"})," ",t.jsx(O,{value:N,onChange:e=>S(e.target.value),size:"small",color:"success",className:"autocomplete",id:"outlined-basic",label:"Số PO",variant:"outlined"})]}),t.jsxs("label",{children:[t.jsx("b",{children:"PO QTY:"})," ",t.jsx(O,{value:H,onChange:e=>Q(e.target.value),size:"small",color:"success",className:"autocomplete",id:"outlined-basic",label:"PO QTY",variant:"outlined"})]}),t.jsxs("label",{children:[t.jsx("b",{children:"Price:"})," ",t.jsx(O,{value:D,onChange:e=>j(e.target.value),size:"small",color:"success",className:"autocomplete",id:"outlined-basic",label:"Price",variant:"outlined"})]}),t.jsxs("label",{children:[t.jsx("b",{children:"Remark:"})," ",t.jsx(O,{value:L,onChange:e=>V(e.target.value),size:"small",color:"success",className:"autocomplete",id:"outlined-basic",label:"Remark",variant:"outlined"})]})]})]}),t.jsxs("div",{className:"dangkybutton",children:[t.jsx("button",{className:"thembutton",onClick:()=>{ht()},children:"Thêm PO"}),t.jsx("button",{className:"suabutton",onClick:()=>{Tt()},children:"Sửa PO"}),t.jsx("button",{className:"xoabutton",onClick:()=>{k()},children:"Clear"}),t.jsx("button",{className:"closebutton",onClick:()=>{p({..._,trapo:!0,thempohangloat:!1,them1po:!1})},children:"Close"})]})]})})}),_.them1invoice&&t.jsx("div",{className:"them1invoice",children:t.jsx("div",{className:"formnho",children:t.jsxs("div",{className:"dangkyform",children:[t.jsx("h3",{children:"Thêm Invoice mới"}),t.jsxs("div",{className:"dangkyinput",children:[t.jsxs("div",{className:"dangkyinputbox",children:[t.jsxs("label",{children:[t.jsx("b",{children:"Khách hàng:"})," ",t.jsx(K,{size:"small",disablePortal:!0,options:re,className:"autocomplete",getOptionLabel:e=>`${e.CUST_CD}: ${e.CUST_NAME_KD}`,renderInput:e=>t.jsx(O,{...e,label:"Select customer"}),value:d,onChange:(e,a)=>{console.log(a),M(a)}})]}),t.jsxs("label",{children:[t.jsx("b",{children:"Code hàng:"})," ",t.jsx(K,{size:"small",disablePortal:!0,options:se,className:"autocomplete",filterOptions:$,getOptionLabel:e=>`${e.G_CODE}: ${e.G_NAME}`,renderInput:e=>t.jsx(O,{...e,label:"Select code"}),onChange:(e,a)=>{console.log(a),j(a===null?"":a.PROD_LAST_PRICE.toString()),v(a)},value:i})]}),t.jsxs("label",{children:[t.jsx("b",{children:"PO Date:"}),t.jsx("input",{onKeyDown:e=>{m(e)},className:"inputdata",type:"date",value:E.slice(0,10),onChange:e=>x(e.target.value)})]}),t.jsxs("label",{children:[t.jsx("b",{children:"RD Date:"})," ",t.jsx("input",{onKeyDown:e=>{m(e)},className:"inputdata",type:"date",value:y.slice(0,10),onChange:e=>b(e.target.value)})]})]}),t.jsxs("div",{className:"dangkyinputbox",children:[t.jsxs("label",{children:[t.jsx("b",{children:"PO NO:"})," ",t.jsx(O,{value:N,onChange:e=>S(e.target.value),size:"small",color:"success",className:"autocomplete",id:"outlined-basic",label:"Số PO",variant:"outlined"})]}),t.jsxs("label",{children:[t.jsx("b",{children:"Invoice QTY:"})," ",t.jsx(O,{value:U,onChange:e=>z(Number(e.target.value)),size:"small",color:"success",className:"autocomplete",id:"outlined-basic",label:"INVOICE QTY",variant:"outlined"})]}),t.jsxs("label",{children:[t.jsx("b",{children:"Invoice Date:"})," ",t.jsx("input",{onKeyDown:e=>{m(e)},className:"inputdata",type:"date",value:R.slice(0,10),onChange:e=>q(e.target.value)})]}),t.jsxs("label",{children:[t.jsx("b",{children:"Remark:"})," ",t.jsx(O,{value:ie,onChange:e=>W(e.target.value),size:"small",className:"autocomplete",id:"outlined-basic",label:"Remark",variant:"outlined"})]})]})]}),t.jsxs("div",{className:"dangkybutton",children:[t.jsx("button",{className:"thembutton",onClick:()=>{dt()},children:"Thêm Invoice"}),t.jsx("button",{className:"suabutton",onClick:()=>{ut()},children:"Clear"}),t.jsx("button",{className:"closebutton",onClick:()=>{p({..._,trapo:!0,thempohangloat:!1,them1po:!1,them1invoice:!1})},children:"Close"})]})]})})}),ge&&t.jsxs("div",{className:"pivottable1",children:[t.jsxs(f,{className:"buttonIcon",onClick:()=>{_e(!1)},children:[t.jsx(bt,{color:"blue",size:25}),"Close"]}),t.jsx(St,{datasource:pt,tableID:"potablepivot"})]})]})};export{Ht as default};

import{r as f,ad as h,S as d,j as t,aj as E,ak as O}from"./index-4ab6dde0.js";/* empty css                     */import{D as T,G as w,b as g}from"./DataGrid-b5e0acb2.js";import{G as S,a as P,b as D}from"./GridToolbarFilterButton-ec6062d3.js";import"./TextField-db9fe3d0.js";import"./MenuItem-8199bc03.js";import"./Typography-b6d023f3.js";const C=()=>{const[A,c]=f.useState(!1),[r,l]=f.useState([]),_=[{field:"id",headerName:"ID",width:100,valueGetter:e=>e.row.OFF_ID},{field:"PHE_DUYET",headerName:"PHE_DUYET",width:200,renderCell:e=>{const s=i=>{i===3?d.fire({title:"Chắc chắn muốn xóa đăng ký nghỉ đã chọn ?",text:"Sẽ xóa đăng ký nghỉ",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Vẫn Xóa!"}).then(o=>{o.isConfirmed&&(d.fire("Tiến hành Xóa","Đang Xóa Đăng ký nghỉ","success"),h("setpheduyetnhom",{off_id:e.row.OFF_ID,pheduyetvalue:i}).then(a=>{if(console.log(a.data.tk_status),a.data.tk_status==="OK"){const n=r.map(N=>N.OFF_ID===e.row.OFF_ID?{...N,APPROVAL_STATUS:i}:N);l(n)}else d.fire("Có lỗi","Nội dung: "+a.data.message,"error")}).catch(a=>{console.log(a)}))}):i===0?h("setpheduyetnhom",{off_id:e.row.OFF_ID,pheduyetvalue:i}).then(o=>{if(console.log(o.data.tk_status),o.data.tk_status==="OK"){const a=r.map(n=>n.OFF_ID===e.row.OFF_ID?{...n,APPROVAL_STATUS:i}:n);l(a)}else d.fire("Có lỗi","Nội dung: "+o.data.message,"error")}).catch(o=>{console.log(o)}):(e.row.ON_OFF===0||e.row.ON_OFF===null||e.row.REASON_NAME==="Nửa phép")&&i===1?h("setpheduyetnhom",{off_id:e.row.OFF_ID,pheduyetvalue:i}).then(o=>{if(console.log(o.data.tk_status),o.data.tk_status==="OK"){const a=r.map(n=>n.OFF_ID===e.row.OFF_ID?{...n,APPROVAL_STATUS:i}:n);l(a)}else d.fire("Có lỗi","Nội dung: "+o.data.message,"error")}).catch(o=>{console.log(o)}):d.fire("Thông báo","Đã điểm danh đi làm, không phê duyệt nghỉ được")},u=()=>{const i=r.map(o=>o.OFF_ID===e.row.OFF_ID?{...o,APPROVAL_STATUS:2}:o);l(i)};return e.row.APPROVAL_STATUS===0?t.jsxs("div",{className:"onoffdiv",children:[t.jsx("span",{style:{fontWeight:"bold",color:"red"},children:"Từ chối"}),t.jsx("button",{className:"resetbutton",onClick:()=>u(),children:"RESET"}),t.jsx("button",{className:"deletebutton",onClick:()=>s(3),children:"XÓA"})]}):e.row.APPROVAL_STATUS===1?t.jsxs("div",{className:"onoffdiv",children:[t.jsx("span",{style:{fontWeight:"bold",color:"green"},children:"Phê Duyệt"}),t.jsx("button",{className:"resetbutton",onClick:()=>u(),children:"RESET"}),t.jsx("button",{className:"deletebutton",onClick:()=>s(3),children:"XÓA"})]}):e.row.APPROVAL_STATUS===3?t.jsx("div",{className:"onoffdiv",children:t.jsx("span",{style:{fontWeight:"bold",color:"red"},children:"Đã xóa"})}):t.jsxs("div",{className:"onoffdiv",children:[t.jsx("button",{className:"onbutton",onClick:()=>s(1),children:"Duyệt"}),t.jsx("button",{className:"offbutton",onClick:()=>s(0),children:"Từ chối"})]})}},{field:"EMPL_NO",headerName:"EMPL_NO",width:120},{field:"CMS_ID",headerName:"CMS_ID",width:120},{field:"MIDLAST_NAME",headerName:"MIDLAST_NAME",width:170},{field:"FIRST_NAME",headerName:"FIRST_NAME",width:100},{field:"REQUEST_DATE",headerName:"REQUEST_DATE",width:110,valueGetter:e=>e.row.REQUEST_DATE.slice(0,10)},{field:"APPLY_DATE",headerName:"APPLY_DATE",width:100,valueGetter:e=>e.row.APPLY_DATE.slice(0,10)},{field:"REASON_NAME",headerName:"REASON_NAME",width:120},{field:"CA_NGHI",headerName:"CA_NGHI",width:80},{field:"REMARK",headerName:"REMARK",width:170},{field:"ON_OFF",headerName:"ON_OFF",width:120},{field:"DOB",headerName:"DOB",width:170,valueGetter:e=>e.row.DOB.slice(0,10)},{field:"POSITION_NAME",headerName:"POSITION_NAME",width:170},{field:"FACTORY_NAME",headerName:"FACTORY_NAME",width:170},{field:"WORK_SHIF_NAME",headerName:"WORK_SHIF_NAME",width:170},{field:"JOB_NAME",headerName:"JOB_NAME",width:170},{field:"MAINDEPTNAME",headerName:"MAINDEPT_NAME",width:170},{field:"SUBDEPTNAME",headerName:"SUBDEPT_NAME",width:170},{field:"WORK_POSITION_NAME",headerName:"WORK_POSITION_NAME",width:170}];function m(){return t.jsxs(w,{children:[t.jsx(S,{}),t.jsx(P,{}),t.jsx(D,{}),t.jsx("button",{className:"saveexcelbutton",onClick:()=>{O(r,"PheDuyetNghi")},children:"Save Excel"}),t.jsx(g,{})]})}return f.useEffect(()=>{c(!0),h("pheduyetnhom",{}).then(e=>{e.data.tk_status!=="NG"?(l(e.data.data),c(!1),d.fire("Thông báo","Đã load "+e.data.data.length+" dòng","success")):d.fire("Thông báo","Nội dung: "+e.data.message,"error")}).catch(e=>{console.log(e),c(!1)})},[]),t.jsxs("div",{className:"pheduyetnghi",children:[t.jsx("h3",{children:"Phê duyệt nghỉ"}),t.jsx("div",{className:"maindept_table",children:t.jsx(T,{sx:{fontSize:"0.8rem"},components:{Toolbar:m,LoadingOverlay:E},loading:A,rowHeight:35,rows:r,columns:_,rowsPerPageOptions:[5,10,50,100,500,1e3,2e3],editMode:"row",getRowHeight:()=>"auto",checkboxSelection:!0,disableSelectionOnClick:!0})})]})};export{C as default};
